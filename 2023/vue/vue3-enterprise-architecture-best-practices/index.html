<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="Orion K">
    
    <title>
        
            Vue 3 企业级应用架构设计与最佳实践 |
        
        Orion K Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="/images/logo.svg">
    
    
<link rel="stylesheet" href="/font/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/font/css/regular.min.css">

    
<link rel="stylesheet" href="/font/css/solid.min.css">

    
<link rel="stylesheet" href="/font/css/brands.min.css">

    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.json"}
    KEEP.theme_config = {"base_info":{"primary_color":"#0066cc","title":"Orion K Blog","author":"Orion K","avatar":"/images/avatar.svg","logo":"/images/logo.svg","favicon":"/images/logo.svg"},"menu":{"home":"/                        || fa-solid fa-home","archives":"/archives            || fa-solid fa-box-archive","categories":"/categories        || fa-solid fa-layer-group"},"first_screen":{"enable":false,"background_img":"/images/bg.svg","background_img_dark":"/images/bg.svg","description":"Keep writing and Keep loving.","hitokoto":false},"social_contact":{"enable":false,"links":{"github":null,"weixin":null,"qq":null,"weibo":null,"zhihu":null,"twitter":null,"x":null,"facebook":null,"email":null}},"scroll":{"progress_bar":false,"percent":false,"hide_header":true},"home":{"announcement":"欢迎来到 Orion K 的博客，这是一个分享互联网技术的博客。联系：wxmm686800@gmail.com","category":true,"tag":true,"post_datetime":"created"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":false,"min2read":false},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":false,"share":false,"reward":{"enable":false,"img_link":null,"text":null,"icon":null}},"code_block":{"tools":{"enable":false,"style":"default"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":false,"site_uv":false,"site_pv":false,"page_pv":false}},"local_search":{"enable":true,"preload":true},"comment":{"enable":false,"use":"valine","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.39"},"waline":{"server_url":null,"reaction":false,"version":"3.3.2"},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false},"artalk":{"server":null},"disqus":{"shortname":null}},"rss":{"enable":false},"lazyload":{"enable":false},"cdn":{"enable":false,"provider":"cdnjs"},"pjax":{"enable":false},"footer":{"since":2025,"word_count":false,"site_deploy":{"enable":true,"provider":"github","url":null},"record":{"enable":false,"list":[{"code":null,"link":null}]}},"inject":{"enable":false,"css":[null],"js":[null]},"root":"","source_data":{},"version":"4.2.5"}
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"}
    KEEP.language_code_block = {"copy":"复制代码","copied":"已复制","fold":"折叠代码块","folded":"已折叠"}
    KEEP.language_copy_copyright = {"copy":"复制版权信息","copied":"已复制","title":"原文标题","author":"原文作者","link":"原文链接"}
  </script>
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
</div>



<main class="page-container border-box">
    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left flex-start border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="/images/logo.svg">
                </a>
            
            <a class="site-name border-box" href="/">
               Orion K Blog
            </a>
        </div>

        <div class="right border-box">
            <div class="pc border-box">
                <ul class="menu-list border-box">
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-home"></i>
                                
                                首页
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/archives">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-box-archive"></i>
                                
                                归档
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/categories">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-layer-group"></i>
                                
                                分类
                                
                            </a>
                            
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="menu-text-color fas search fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile border-box flex-start">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list border-box">
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-home"></i>
                                </span>
                            
                            首页
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/archives">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-box-archive"></i>
                                </span>
                            
                            归档
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/categories">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-layer-group"></i>
                                </span>
                            
                            分类
                        </a>
                        
                    </label>
                    
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">
                

                    
<div class="fade-in-down-animation">
    <div class="post-page-container border-box">
        <div class="post-content-container border-box">
            

            <div class="post-content-bottom border-box">
                
                    <div class="post-title">
                        Vue 3 企业级应用架构设计与最佳实践
                    </div>
                

                
                    <div class="post-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="/images/avatar.svg">
                            </div>
                        
                        <div class="info-box">
                            <div class="author border-box">
                                <span class="name">Orion K</span>
                                
                                    <span class="author-badge">Lv6</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="post-meta-info-container border-box post">
    <div class="post-meta-info border-box">
        

        
            <span class="meta-info-item post-create-date">
                <i class="icon fa-solid fa-calendar-plus"></i>&nbsp;
                <span class="datetime">2023-11-15 14:30:00</span>
            </span>
        

        
            <span class="meta-info-item post-category border-box"><i class="icon fas fa-folder"></i>&nbsp;
                <ul class="post-category-ul">
                    
                            <li class="category-item"><a href="/categories/vue/">vue</a></li>
                        
                    
                </ul>
            </span>
        

        
            <span class="post-tag meta-info-item border-box">
                <ul class="post-tag-ul">
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/Vue3/">Vue3</a></li>
                        
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/TypeScript/">TypeScript</a></li>
                        
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/">架构设计</a></li>
                        
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%BA%94%E7%94%A8/">企业级应用</a></li>
                        
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/%E6%A8%A1%E5%9D%97%E5%8C%96%E5%BC%80%E5%8F%91/">模块化开发</a></li>
                        
                    
                </ul>
            </span>
        

        
        
        
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="post-content keep-markdown-body ">
                    

                    
                         <h1 id="Vue-3-企业级应用架构设计与最佳实践"><a href="#Vue-3-企业级应用架构设计与最佳实践" class="headerlink" title="Vue 3 企业级应用架构设计与最佳实践"></a>Vue 3 企业级应用架构设计与最佳实践</h1><p>随着 Vue 3 的正式发布和生态系统的不断完善，越来越多的企业开始采用 Vue 3 构建大型前端应用。本文将深入探讨如何使用 Vue 3 设计和构建企业级应用架构，涵盖模块化开发、TypeScript 集成、微前端架构等关键技术。</p>
<h2 id="企业级应用架构设计原则"><a href="#企业级应用架构设计原则" class="headerlink" title="企业级应用架构设计原则"></a>企业级应用架构设计原则</h2><h3 id="1-分层架构设计"><a href="#1-分层架构设计" class="headerlink" title="1. 分层架构设计"></a>1. 分层架构设计</h3><p>企业级应用需要清晰的分层架构来保证代码的可维护性和可扩展性。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/types/architecture.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 应用架构分层定义</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 定义企业级应用的分层架构</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">ArchitectureLayers</span> &#123;</span><br><span class="line">  <span class="attr">presentation</span>: <span class="title class_">PresentationLayer</span>;    <span class="comment">// 表现层</span></span><br><span class="line">  <span class="attr">business</span>: <span class="title class_">BusinessLayer</span>;            <span class="comment">// 业务层</span></span><br><span class="line">  <span class="attr">data</span>: <span class="title class_">DataLayer</span>;                   <span class="comment">// 数据层</span></span><br><span class="line">  <span class="attr">infrastructure</span>: <span class="title class_">InfrastructureLayer</span>; <span class="comment">// 基础设施层</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 表现层接口定义</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 负责用户界面和用户交互</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">PresentationLayer</span> &#123;</span><br><span class="line">  <span class="attr">components</span>: <span class="title class_">ComponentModule</span>[];      <span class="comment">// 组件模块</span></span><br><span class="line">  <span class="attr">pages</span>: <span class="title class_">PageModule</span>[];               <span class="comment">// 页面模块</span></span><br><span class="line">  <span class="attr">layouts</span>: <span class="title class_">LayoutModule</span>[];           <span class="comment">// 布局模块</span></span><br><span class="line">  <span class="attr">directives</span>: <span class="title class_">DirectiveModule</span>[];     <span class="comment">// 指令模块</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 业务层接口定义</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 负责业务逻辑处理</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">BusinessLayer</span> &#123;</span><br><span class="line">  <span class="attr">services</span>: <span class="title class_">ServiceModule</span>[];         <span class="comment">// 服务模块</span></span><br><span class="line">  <span class="attr">stores</span>: <span class="title class_">StoreModule</span>[];            <span class="comment">// 状态管理模块</span></span><br><span class="line">  <span class="attr">composables</span>: <span class="title class_">ComposableModule</span>[];  <span class="comment">// 组合式函数模块</span></span><br><span class="line">  <span class="attr">validators</span>: <span class="title class_">ValidatorModule</span>[];    <span class="comment">// 验证器模块</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-模块化开发策略"><a href="#2-模块化开发策略" class="headerlink" title="2. 模块化开发策略"></a>2. 模块化开发策略</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/modules/user/index.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用户模块统一导出</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 用户相关功能的模块化封装</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">UserService</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./services/UserService&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">UserStore</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./stores/UserStore&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">UserComponents</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./components&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> <span class="title class_">UserRoutes</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./routes&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&#x27;./types&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">&#x27;./composables&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// src/modules/user/services/UserService.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用户服务类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 处理用户相关的业务逻辑</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ApiClient</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/infrastructure/http&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">User</span>, <span class="title class_">CreateUserDto</span>, <span class="title class_">UpdateUserDto</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../types&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">apiClient</span>: <span class="title class_">ApiClient</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">apiClient</span>: <span class="title class_">ApiClient</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">apiClient</span> = apiClient;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 获取用户列表</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> params 查询参数</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span> Promise&lt;User[]&gt; 用户列表</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@throws</span> &#123;<span class="type">ApiError</span>&#125; 当请求失败时抛出异常</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">getUsers</span>(<span class="attr">params</span>?: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt;): <span class="title class_">Promise</span>&lt;<span class="title class_">User</span>[]&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">apiClient</span>.<span class="title function_">get</span>(<span class="string">&#x27;/users&#x27;</span>, &#123; params &#125;);</span><br><span class="line">      <span class="keyword">return</span> response.<span class="property">data</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`获取用户列表失败: <span class="subst">$&#123;error.message&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 创建用户</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> userData 用户数据</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span> Promise&lt;User&gt; 创建的用户信息</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@throws</span> &#123;<span class="type">ValidationError</span>&#125; 当数据验证失败时抛出异常</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">createUser</span>(<span class="attr">userData</span>: <span class="title class_">CreateUserDto</span>): <span class="title class_">Promise</span>&lt;<span class="title class_">User</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">apiClient</span>.<span class="title function_">post</span>(<span class="string">&#x27;/users&#x27;</span>, userData);</span><br><span class="line">      <span class="keyword">return</span> response.<span class="property">data</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`创建用户失败: <span class="subst">$&#123;error.message&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">UserService</span>;</span><br></pre></td></tr></table></figure>

<h3 id="3-TypeScript-集成与类型安全"><a href="#3-TypeScript-集成与类型安全" class="headerlink" title="3. TypeScript 集成与类型安全"></a>3. TypeScript 集成与类型安全</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/types/api.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * API 响应基础类型定义</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 统一的 API 响应格式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">ApiResponse</span>&lt;T = <span class="built_in">any</span>&gt; &#123;</span><br><span class="line">  <span class="attr">code</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">message</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">data</span>: T;</span><br><span class="line">  <span class="attr">timestamp</span>: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分页响应类型定义</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 分页数据的响应格式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">PaginatedResponse</span>&lt;T&gt; <span class="keyword">extends</span> <span class="title class_">ApiResponse</span>&lt;T[]&gt; &#123;</span><br><span class="line">  <span class="attr">pagination</span>: &#123;</span><br><span class="line">    <span class="attr">page</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">pageSize</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">total</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">totalPages</span>: <span class="built_in">number</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// src/infrastructure/http/ApiClient.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * API 客户端类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 封装 HTTP 请求，提供类型安全的 API 调用</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> axios, &#123; <span class="title class_">AxiosInstance</span>, <span class="title class_">AxiosRequestConfig</span>, <span class="title class_">AxiosResponse</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">ApiResponse</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/api&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">ApiClient</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">instance</span>: <span class="title class_">AxiosInstance</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">baseURL</span>: <span class="built_in">string</span>, <span class="attr">timeout</span>: <span class="built_in">number</span> = <span class="number">10000</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">instance</span> = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">      baseURL,</span><br><span class="line">      timeout,</span><br><span class="line">      <span class="attr">headers</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setupInterceptors</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 设置请求和响应拦截器</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@description</span> 统一处理请求头、错误处理等</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">setupInterceptors</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="comment">// 请求拦截器</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">instance</span>.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">      <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> token = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;access_token&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (token) &#123;</span><br><span class="line">          config.<span class="property">headers</span>.<span class="property">Authorization</span> = <span class="string">`Bearer <span class="subst">$&#123;token&#125;</span>`</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> config;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="function">(<span class="params">error</span>) =&gt;</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 响应拦截器</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">instance</span>.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">      <span class="function">(<span class="params"><span class="attr">response</span>: <span class="title class_">AxiosResponse</span>&lt;<span class="title class_">ApiResponse</span>&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> !== <span class="number">200</span>) &#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> response;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (error.<span class="property">response</span>?.<span class="property">status</span> === <span class="number">401</span>) &#123;</span><br><span class="line">          <span class="comment">// 处理未授权错误</span></span><br><span class="line">          <span class="variable language_">localStorage</span>.<span class="title function_">removeItem</span>(<span class="string">&#x27;access_token&#x27;</span>);</span><br><span class="line">          <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&#x27;/login&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * GET 请求</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> url 请求地址</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> config 请求配置</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span> Promise&lt;AxiosResponse&lt;ApiResponse&lt;T&gt;&gt;&gt; 响应数据</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">async</span> get&lt;T = <span class="built_in">any</span>&gt;(</span><br><span class="line">    <span class="attr">url</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">config</span>?: <span class="title class_">AxiosRequestConfig</span></span><br><span class="line">  ): <span class="title class_">Promise</span>&lt;<span class="title class_">AxiosResponse</span>&lt;<span class="title class_">ApiResponse</span>&lt;T&gt;&gt;&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">instance</span>.<span class="title function_">get</span>(url, config);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * POST 请求</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> url 请求地址</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> data 请求数据</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> config 请求配置</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span> Promise&lt;AxiosResponse&lt;ApiResponse&lt;T&gt;&gt;&gt; 响应数据</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">async</span> post&lt;T = <span class="built_in">any</span>&gt;(</span><br><span class="line">    <span class="attr">url</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">data</span>?: <span class="built_in">any</span>,</span><br><span class="line">    <span class="attr">config</span>?: <span class="title class_">AxiosRequestConfig</span></span><br><span class="line">  ): <span class="title class_">Promise</span>&lt;<span class="title class_">AxiosResponse</span>&lt;<span class="title class_">ApiResponse</span>&lt;T&gt;&gt;&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">instance</span>.<span class="title function_">post</span>(url, data, config);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="状态管理架构设计"><a href="#状态管理架构设计" class="headerlink" title="状态管理架构设计"></a>状态管理架构设计</h2><h3 id="1-Pinia-企业级状态管理"><a href="#1-Pinia-企业级状态管理" class="headerlink" title="1. Pinia 企业级状态管理"></a>1. Pinia 企业级状态管理</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/stores/modules/app.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 应用全局状态管理</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 管理应用级别的状态，如主题、语言、菜单等</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">Theme</span>, <span class="title class_">Language</span>, <span class="title class_">MenuItem</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/app&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useAppStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;app&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 状态定义</span></span><br><span class="line">  <span class="keyword">const</span> theme = ref&lt;<span class="title class_">Theme</span>&gt;(<span class="string">&#x27;light&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> language = ref&lt;<span class="title class_">Language</span>&gt;(<span class="string">&#x27;zh-CN&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> menuCollapsed = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">const</span> menuItems = ref&lt;<span class="title class_">MenuItem</span>[]&gt;([]);</span><br><span class="line">  <span class="keyword">const</span> loading = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 计算属性</span></span><br><span class="line">  <span class="keyword">const</span> isDarkTheme = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> theme.<span class="property">value</span> === <span class="string">&#x27;dark&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> currentLocale = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> language.<span class="property">value</span> === <span class="string">&#x27;zh-CN&#x27;</span> ? <span class="string">&#x27;zh&#x27;</span> : <span class="string">&#x27;en&#x27;</span>;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 切换主题</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> newTheme 新主题</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@description</span> 切换应用主题并持久化到本地存储</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">toggleTheme</span> = (<span class="params"><span class="attr">newTheme</span>?: <span class="title class_">Theme</span></span>) =&gt; &#123;</span><br><span class="line">    theme.<span class="property">value</span> = newTheme || (theme.<span class="property">value</span> === <span class="string">&#x27;light&#x27;</span> ? <span class="string">&#x27;dark&#x27;</span> : <span class="string">&#x27;light&#x27;</span>);</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;app_theme&#x27;</span>, theme.<span class="property">value</span>);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">setAttribute</span>(<span class="string">&#x27;data-theme&#x27;</span>, theme.<span class="property">value</span>);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 切换语言</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> newLanguage 新语言</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@description</span> 切换应用语言并重新加载菜单</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">changeLanguage</span> = <span class="keyword">async</span> (<span class="params"><span class="attr">newLanguage</span>: <span class="title class_">Language</span></span>) =&gt; &#123;</span><br><span class="line">    language.<span class="property">value</span> = newLanguage;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;app_language&#x27;</span>, newLanguage);</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">loadMenuItems</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 加载菜单项</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@description</span> 根据用户权限和语言加载菜单</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">loadMenuItems</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      loading.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">      <span class="comment">// 这里应该调用 API 获取菜单数据</span></span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`/api/menus?lang=<span class="subst">$&#123;language.value&#125;</span>`</span>);</span><br><span class="line">      <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span><br><span class="line">      menuItems.<span class="property">value</span> = data.<span class="property">data</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;加载菜单失败:&#x27;</span>, error);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      loading.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 初始化应用状态</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@description</span> 从本地存储恢复状态并初始化应用</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">initializeApp</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 恢复主题设置</span></span><br><span class="line">    <span class="keyword">const</span> savedTheme = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;app_theme&#x27;</span>) <span class="keyword">as</span> <span class="title class_">Theme</span>;</span><br><span class="line">    <span class="keyword">if</span> (savedTheme) &#123;</span><br><span class="line">      <span class="title function_">toggleTheme</span>(savedTheme);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 恢复语言设置</span></span><br><span class="line">    <span class="keyword">const</span> savedLanguage = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;app_language&#x27;</span>) <span class="keyword">as</span> <span class="title class_">Language</span>;</span><br><span class="line">    <span class="keyword">if</span> (savedLanguage) &#123;</span><br><span class="line">      language.<span class="property">value</span> = savedLanguage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 加载菜单</span></span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">loadMenuItems</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// 状态</span></span><br><span class="line">    theme,</span><br><span class="line">    language,</span><br><span class="line">    menuCollapsed,</span><br><span class="line">    menuItems,</span><br><span class="line">    loading,</span><br><span class="line">    <span class="comment">// 计算属性</span></span><br><span class="line">    isDarkTheme,</span><br><span class="line">    currentLocale,</span><br><span class="line">    <span class="comment">// 方法</span></span><br><span class="line">    toggleTheme,</span><br><span class="line">    changeLanguage,</span><br><span class="line">    loadMenuItems,</span><br><span class="line">    initializeApp,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="2-状态持久化与同步"><a href="#2-状态持久化与同步" class="headerlink" title="2. 状态持久化与同步"></a>2. 状态持久化与同步</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/plugins/pinia-persistence.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Pinia 状态持久化插件</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 自动持久化指定的状态到本地存储</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">PiniaPluginContext</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">PersistenceOptions</span> &#123;</span><br><span class="line">  <span class="attr">key</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">storage</span>?: <span class="title class_">Storage</span>;</span><br><span class="line">  <span class="attr">paths</span>?: <span class="built_in">string</span>[];</span><br><span class="line">  <span class="attr">serializer</span>?: &#123;</span><br><span class="line">    <span class="attr">serialize</span>: <span class="function">(<span class="params"><span class="attr">value</span>: <span class="built_in">any</span></span>) =&gt;</span> <span class="built_in">string</span>;</span><br><span class="line">    <span class="attr">deserialize</span>: <span class="function">(<span class="params"><span class="attr">value</span>: <span class="built_in">string</span></span>) =&gt;</span> <span class="built_in">any</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建持久化插件</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> options 持久化配置选项</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> Pinia 插件函数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">createPersistencePlugin</span>(<span class="params"><span class="attr">options</span>: <span class="title class_">PersistenceOptions</span> = &#123;&#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">&#123; store, options: storeOptions &#125;: <span class="title class_">PiniaPluginContext</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;</span><br><span class="line">      key = store.<span class="property">$id</span>,</span><br><span class="line">      storage = <span class="variable language_">localStorage</span>,</span><br><span class="line">      paths,</span><br><span class="line">      serializer = &#123;</span><br><span class="line">        <span class="attr">serialize</span>: <span class="title class_">JSON</span>.<span class="property">stringify</span>,</span><br><span class="line">        <span class="attr">deserialize</span>: <span class="title class_">JSON</span>.<span class="property">parse</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125; = &#123; ...options, ...storeOptions.<span class="property">persist</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从存储中恢复状态</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">restoreState</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> stored = storage.<span class="title function_">getItem</span>(key);</span><br><span class="line">        <span class="keyword">if</span> (stored) &#123;</span><br><span class="line">          <span class="keyword">const</span> state = serializer.<span class="title function_">deserialize</span>(stored);</span><br><span class="line">          <span class="keyword">if</span> (paths) &#123;</span><br><span class="line">            <span class="comment">// 只恢复指定路径的状态</span></span><br><span class="line">            paths.<span class="title function_">forEach</span>(<span class="function"><span class="params">path</span> =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">if</span> (path <span class="keyword">in</span> state) &#123;</span><br><span class="line">                store.$patch(&#123; [path]: state[path] &#125;);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            store.$patch(state);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`恢复状态失败 (<span class="subst">$&#123;key&#125;</span>):`</span>, error);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 保存状态到存储</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">saveState</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> stateToSave = store.<span class="property">$state</span>;</span><br><span class="line">        <span class="keyword">if</span> (paths) &#123;</span><br><span class="line">          stateToSave = paths.<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, path</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (path <span class="keyword">in</span> store.<span class="property">$state</span>) &#123;</span><br><span class="line">              acc[path] = store.<span class="property">$state</span>[path];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> acc;</span><br><span class="line">          &#125;, &#123;&#125; <span class="keyword">as</span> <span class="built_in">any</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        storage.<span class="title function_">setItem</span>(key, serializer.<span class="title function_">serialize</span>(stateToSave));</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`保存状态失败 (<span class="subst">$&#123;key&#125;</span>):`</span>, error);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 恢复状态</span></span><br><span class="line">    <span class="title function_">restoreState</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 监听状态变化并自动保存</span></span><br><span class="line">    store.$subscribe(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">saveState</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="组件架构设计"><a href="#组件架构设计" class="headerlink" title="组件架构设计"></a>组件架构设计</h2><h3 id="1-基础组件库架构"><a href="#1-基础组件库架构" class="headerlink" title="1. 基础组件库架构"></a>1. 基础组件库架构</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/components/base/Button/Button.vue</span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">:class</span>=<span class="string">&quot;buttonClasses&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">:disabled</span>=<span class="string">&quot;disabled || loading&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">:type</span>=<span class="string">&quot;htmlType&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    @<span class="attr">click</span>=<span class="string">&quot;handleClick&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  &gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Icon</span> <span class="attr">v-if</span>=<span class="string">&quot;loading&quot;</span> <span class="attr">name</span>=<span class="string">&quot;loading&quot;</span> <span class="attr">class</span>=<span class="string">&quot;animate-spin&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Icon</span> <span class="attr">v-else-if</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">:name</span>=<span class="string">&quot;icon&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">&quot;$slots.default&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button-content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">slot</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">/**</span><br><span class="line"> * 基础按钮组件</span><br><span class="line"> * @description 企业级应用的基础按钮组件，支持多种样式和状态</span><br><span class="line"> */</span><br><span class="line">import &#123; computed &#125; from &#x27;vue&#x27;;</span><br><span class="line">import Icon from &#x27;../Icon/Icon.vue&#x27;;</span><br><span class="line"></span><br><span class="line">// 组件属性定义</span><br><span class="line">interface ButtonProps &#123;</span><br><span class="line">  type?: &#x27;primary&#x27; | &#x27;secondary&#x27; | &#x27;success&#x27; | &#x27;warning&#x27; | &#x27;danger&#x27;;</span><br><span class="line">  size?: &#x27;small&#x27; | &#x27;medium&#x27; | &#x27;large&#x27;;</span><br><span class="line">  variant?: &#x27;solid&#x27; | &#x27;outline&#x27; | &#x27;ghost&#x27;;</span><br><span class="line">  disabled?: boolean;</span><br><span class="line">  loading?: boolean;</span><br><span class="line">  icon?: string;</span><br><span class="line">  htmlType?: &#x27;button&#x27; | &#x27;submit&#x27; | &#x27;reset&#x27;;</span><br><span class="line">  block?: boolean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 事件定义</span><br><span class="line">interface ButtonEmits &#123;</span><br><span class="line">  click: [event: MouseEvent];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const props = withDefaults(defineProps&lt;ButtonProps&gt;(), &#123;</span><br><span class="line">  type: &#x27;primary&#x27;,</span><br><span class="line">  size: &#x27;medium&#x27;,</span><br><span class="line">  variant: &#x27;solid&#x27;,</span><br><span class="line">  disabled: false,</span><br><span class="line">  loading: false,</span><br><span class="line">  htmlType: &#x27;button&#x27;,</span><br><span class="line">  block: false,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const emit = defineEmits&lt;ButtonEmits&gt;();</span><br><span class="line"></span><br><span class="line">// 计算按钮样式类</span><br><span class="line">const buttonClasses = computed(() =&gt; &#123;</span><br><span class="line">  return [</span><br><span class="line">    &#x27;btn&#x27;,</span><br><span class="line">    `btn--$&#123;props.type&#125;`,</span><br><span class="line">    `btn--$&#123;props.size&#125;`,</span><br><span class="line">    `btn--$&#123;props.variant&#125;`,</span><br><span class="line">    &#123;</span><br><span class="line">      &#x27;btn--disabled&#x27;: props.disabled,</span><br><span class="line">      &#x27;btn--loading&#x27;: props.loading,</span><br><span class="line">      &#x27;btn--block&#x27;: props.block,</span><br><span class="line">    &#125;,</span><br><span class="line">  ];</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 处理按钮点击事件</span><br><span class="line"> * @param event 鼠标事件</span><br><span class="line"> * @description 在非禁用和非加载状态下触发点击事件</span><br><span class="line"> */</span><br><span class="line">const handleClick = (event: MouseEvent) =&gt; &#123;</span><br><span class="line">  if (!props.disabled &amp;&amp; !props.loading) &#123;</span><br><span class="line">    emit(&#x27;click&#x27;, event);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.btn &#123;</span><br><span class="line">  @apply inline-flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.btn--small &#123;</span><br><span class="line">  @apply px-3 py-1.5 text-xs;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.btn--large &#123;</span><br><span class="line">  @apply px-6 py-3 text-base;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.btn--block &#123;</span><br><span class="line">  @apply w-full;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.btn--primary.btn--solid &#123;</span><br><span class="line">  @apply bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.btn--primary.btn--outline &#123;</span><br><span class="line">  @apply border-2 border-blue-600 text-blue-600 hover:bg-blue-50 focus:ring-blue-500;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.btn--disabled &#123;</span><br><span class="line">  @apply opacity-50 cursor-not-allowed;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.animate-spin &#123;</span><br><span class="line">  animation: spin 1s linear infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@keyframes spin &#123;</span><br><span class="line">  from &#123; transform: rotate(0deg); &#125;</span><br><span class="line">  to &#123; transform: rotate(360deg); &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="2-高阶组件模式"><a href="#2-高阶组件模式" class="headerlink" title="2. 高阶组件模式"></a>2. 高阶组件模式</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/components/hoc/withLoading.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 加载状态高阶组件</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 为组件添加加载状态功能</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineComponent, h, ref, <span class="keyword">type</span> <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">LoadingSpinner</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/base/LoadingSpinner.vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">WithLoadingOptions</span> &#123;</span><br><span class="line">  <span class="attr">loadingText</span>?: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">showOverlay</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建带加载状态的高阶组件</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> WrappedComponent 被包装的组件</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> options 配置选项</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> 包装后的组件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> withLoading&lt;T <span class="keyword">extends</span> <span class="title class_">Component</span>&gt;(</span><br><span class="line">  <span class="title class_">WrappedComponent</span>: T,</span><br><span class="line">  <span class="attr">options</span>: <span class="title class_">WithLoadingOptions</span> = &#123;&#125;</span><br><span class="line">) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">defineComponent</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">`WithLoading(<span class="subst">$&#123;WrappedComponent.name || <span class="string">&#x27;Component&#x27;</span>&#125;</span>)`</span>,</span><br><span class="line">    <span class="attr">props</span>: &#123;</span><br><span class="line">      <span class="attr">loading</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span><br><span class="line">        <span class="attr">default</span>: <span class="literal">false</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">setup</span>(<span class="params">props, &#123; attrs, slots &#125;</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; loadingText = <span class="string">&#x27;加载中...&#x27;</span>, showOverlay = <span class="literal">true</span> &#125; = options;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> wrappedComponent = <span class="title function_">h</span>(<span class="title class_">WrappedComponent</span>, attrs, slots);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!props.<span class="property">loading</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> wrappedComponent;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (showOverlay) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="title function_">h</span>(<span class="string">&#x27;div&#x27;</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;relative&#x27;</span> &#125;, [</span><br><span class="line">            wrappedComponent,</span><br><span class="line">            <span class="title function_">h</span>(</span><br><span class="line">              <span class="string">&#x27;div&#x27;</span>,</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">class</span>: <span class="string">&#x27;absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center z-10&#x27;</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">              [</span><br><span class="line">                <span class="title function_">h</span>(<span class="title class_">LoadingSpinner</span>, &#123; <span class="attr">text</span>: loadingText &#125;),</span><br><span class="line">              ]</span><br><span class="line">            ),</span><br><span class="line">          ]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">h</span>(<span class="string">&#x27;div&#x27;</span>, &#123; <span class="attr">class</span>: <span class="string">&#x27;space-y-4&#x27;</span> &#125;, [</span><br><span class="line">          <span class="title function_">h</span>(<span class="title class_">LoadingSpinner</span>, &#123; <span class="attr">text</span>: loadingText &#125;),</span><br><span class="line">          wrappedComponent,</span><br><span class="line">        ]);</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="路由架构设计"><a href="#路由架构设计" class="headerlink" title="路由架构设计"></a>路由架构设计</h2><h3 id="1-模块化路由配置"><a href="#1-模块化路由配置" class="headerlink" title="1. 模块化路由配置"></a>1. 模块化路由配置</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/modules/user.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用户模块路由配置</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 用户相关页面的路由定义</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">RouteRecordRaw</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">userRoutes</span>: <span class="title class_">RouteRecordRaw</span>[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/users&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Users&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/layouts/DefaultLayout.vue&#x27;</span>),</span><br><span class="line">    <span class="attr">meta</span>: &#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;用户管理&#x27;</span>,</span><br><span class="line">      <span class="attr">requiresAuth</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">permissions</span>: [<span class="string">&#x27;user:read&#x27;</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;UserList&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/modules/user/pages/UserList.vue&#x27;</span>),</span><br><span class="line">        <span class="attr">meta</span>: &#123;</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&#x27;用户列表&#x27;</span>,</span><br><span class="line">          <span class="attr">keepAlive</span>: <span class="literal">true</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;create&#x27;</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;UserCreate&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/modules/user/pages/UserCreate.vue&#x27;</span>),</span><br><span class="line">        <span class="attr">meta</span>: &#123;</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&#x27;创建用户&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;:id/edit&#x27;</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;UserEdit&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/modules/user/pages/UserEdit.vue&#x27;</span>),</span><br><span class="line">        <span class="attr">meta</span>: &#123;</span><br><span class="line">          <span class="attr">title</span>: <span class="string">&#x27;编辑用户&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">props</span>: <span class="literal">true</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> userRoutes;</span><br></pre></td></tr></table></figure>

<h3 id="2-路由守卫与权限控制"><a href="#2-路由守卫与权限控制" class="headerlink" title="2. 路由守卫与权限控制"></a>2. 路由守卫与权限控制</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/router/guards/auth.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 认证路由守卫</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 处理用户认证和权限验证</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; <span class="title class_">NavigationGuardNext</span>, <span class="title class_">RouteLocationNormalized</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAuthStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores/modules/auth&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; usePermissionStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores/modules/permission&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 认证守卫</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> to 目标路由</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> from 来源路由</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> next 导航函数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 检查用户是否已登录，未登录则跳转到登录页</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">authGuard</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">to</span>: <span class="title class_">RouteLocationNormalized</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">from</span>: <span class="title class_">RouteLocationNormalized</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">next</span>: <span class="title class_">NavigationGuardNext</span></span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> authStore = <span class="title function_">useAuthStore</span>();</span><br><span class="line">  <span class="keyword">const</span> permissionStore = <span class="title function_">usePermissionStore</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 检查是否需要认证</span></span><br><span class="line">  <span class="keyword">if</span> (to.<span class="property">meta</span>.<span class="property">requiresAuth</span>) &#123;</span><br><span class="line">    <span class="comment">// 检查是否已登录</span></span><br><span class="line">    <span class="keyword">if</span> (!authStore.<span class="property">isAuthenticated</span>) &#123;</span><br><span class="line">      <span class="comment">// 尝试从 token 恢复用户信息</span></span><br><span class="line">      <span class="keyword">const</span> token = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&#x27;access_token&#x27;</span>);</span><br><span class="line">      <span class="keyword">if</span> (token) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">await</span> authStore.<span class="title function_">getCurrentUser</span>();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">          <span class="comment">// token 无效，清除并跳转到登录页</span></span><br><span class="line">          authStore.<span class="title function_">logout</span>();</span><br><span class="line">          <span class="title function_">next</span>(&#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;Login&#x27;</span>,</span><br><span class="line">            <span class="attr">query</span>: &#123; <span class="attr">redirect</span>: to.<span class="property">fullPath</span> &#125;,</span><br><span class="line">          &#125;);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 没有 token，跳转到登录页</span></span><br><span class="line">        <span class="title function_">next</span>(&#123;</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;Login&#x27;</span>,</span><br><span class="line">          <span class="attr">query</span>: &#123; <span class="attr">redirect</span>: to.<span class="property">fullPath</span> &#125;,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查权限</span></span><br><span class="line">    <span class="keyword">if</span> (to.<span class="property">meta</span>.<span class="property">permissions</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> hasPermission = permissionStore.<span class="title function_">hasPermissions</span>(to.<span class="property">meta</span>.<span class="property">permissions</span>);</span><br><span class="line">      <span class="keyword">if</span> (!hasPermission) &#123;</span><br><span class="line">        <span class="title function_">next</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;Forbidden&#x27;</span> &#125;);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 权限守卫</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> to 目标路由</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> from 来源路由</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> next 导航函数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 检查用户是否有访问特定路由的权限</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">permissionGuard</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">to</span>: <span class="title class_">RouteLocationNormalized</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">from</span>: <span class="title class_">RouteLocationNormalized</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">next</span>: <span class="title class_">NavigationGuardNext</span></span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> permissionStore = <span class="title function_">usePermissionStore</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 检查路由权限</span></span><br><span class="line">  <span class="keyword">if</span> (to.<span class="property">meta</span>.<span class="property">permissions</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> hasPermission = permissionStore.<span class="title function_">hasPermissions</span>(to.<span class="property">meta</span>.<span class="property">permissions</span>);</span><br><span class="line">    <span class="keyword">if</span> (!hasPermission) &#123;</span><br><span class="line">      <span class="title function_">next</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;Forbidden&#x27;</span> &#125;);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 检查角色权限</span></span><br><span class="line">  <span class="keyword">if</span> (to.<span class="property">meta</span>.<span class="property">roles</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> hasRole = permissionStore.<span class="title function_">hasRoles</span>(to.<span class="property">meta</span>.<span class="property">roles</span>);</span><br><span class="line">    <span class="keyword">if</span> (!hasRole) &#123;</span><br><span class="line">      <span class="title function_">next</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;Forbidden&#x27;</span> &#125;);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="性能优化策略"><a href="#性能优化策略" class="headerlink" title="性能优化策略"></a>性能优化策略</h2><h3 id="1-组件懒加载与代码分割"><a href="#1-组件懒加载与代码分割" class="headerlink" title="1. 组件懒加载与代码分割"></a>1. 组件懒加载与代码分割</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/utils/lazy-loading.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 组件懒加载工具</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 提供组件懒加载和错误处理功能</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineAsyncComponent, <span class="keyword">type</span> <span class="title class_">AsyncComponentLoader</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">LoadingComponent</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/base/LoadingComponent.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ErrorComponent</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/base/ErrorComponent.vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">LazyLoadOptions</span> &#123;</span><br><span class="line">  <span class="attr">delay</span>?: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">timeout</span>?: <span class="built_in">number</span>;</span><br><span class="line">  <span class="attr">suspensible</span>?: <span class="built_in">boolean</span>;</span><br><span class="line">  <span class="attr">retryTimes</span>?: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建懒加载组件</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> loader 组件加载器函数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> options 懒加载配置选项</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> 异步组件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">createLazyComponent</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">loader</span>: <span class="title class_">AsyncComponentLoader</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">options</span>: <span class="title class_">LazyLoadOptions</span> = &#123;&#125;</span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123;</span><br><span class="line">    delay = <span class="number">200</span>,</span><br><span class="line">    timeout = <span class="number">30000</span>,</span><br><span class="line">    suspensible = <span class="literal">false</span>,</span><br><span class="line">    retryTimes = <span class="number">3</span>,</span><br><span class="line">  &#125; = options;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> retryCount = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">retryLoader</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">await</span> <span class="title function_">loader</span>();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">if</span> (retryCount &lt; retryTimes) &#123;</span><br><span class="line">        retryCount++;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">`组件加载失败，正在重试 (<span class="subst">$&#123;retryCount&#125;</span>/<span class="subst">$&#123;retryTimes&#125;</span>)...`</span>);</span><br><span class="line">        <span class="comment">// 延迟重试</span></span><br><span class="line">        <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">1000</span> * retryCount));</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">retryLoader</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">throw</span> error;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">defineAsyncComponent</span>(&#123;</span><br><span class="line">    <span class="attr">loader</span>: retryLoader,</span><br><span class="line">    <span class="attr">loadingComponent</span>: <span class="title class_">LoadingComponent</span>,</span><br><span class="line">    <span class="attr">errorComponent</span>: <span class="title class_">ErrorComponent</span>,</span><br><span class="line">    delay,</span><br><span class="line">    timeout,</span><br><span class="line">    suspensible,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 路由级别的懒加载</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> importFn 动态导入函数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> 路由组件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">lazyRoute</span>(<span class="params"><span class="attr">importFn</span>: () =&gt; <span class="title class_">Promise</span>&lt;<span class="built_in">any</span>&gt;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">createLazyComponent</span>(importFn, &#123;</span><br><span class="line">    <span class="attr">delay</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">timeout</span>: <span class="number">10000</span>,</span><br><span class="line">    <span class="attr">retryTimes</span>: <span class="number">2</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-虚拟滚动优化"><a href="#2-虚拟滚动优化" class="headerlink" title="2. 虚拟滚动优化"></a>2. 虚拟滚动优化</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- src/components/base/VirtualList.vue --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div</span><br><span class="line">    ref=&quot;containerRef&quot;</span><br><span class="line">    class=&quot;virtual-list&quot;</span><br><span class="line">    :style=&quot;&#123; height: `$&#123;height&#125;px` &#125;&quot;</span><br><span class="line">    @scroll=&quot;handleScroll&quot;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;div</span><br><span class="line">      class=&quot;virtual-list-phantom&quot;</span><br><span class="line">      :style=&quot;&#123; height: `$&#123;totalHeight&#125;px` &#125;&quot;</span><br><span class="line">    &gt;&lt;/div&gt;</span><br><span class="line">    &lt;div</span><br><span class="line">      class=&quot;virtual-list-content&quot;</span><br><span class="line">      :style=&quot;&#123;</span><br><span class="line">        transform: `translateY($&#123;offsetY&#125;px)`,</span><br><span class="line">      &#125;&quot;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;div</span><br><span class="line">        v-for=&quot;item in visibleItems&quot;</span><br><span class="line">        :key=&quot;getItemKey(item)&quot;</span><br><span class="line">        class=&quot;virtual-list-item&quot;</span><br><span class="line">        :style=&quot;&#123; height: `$&#123;itemHeight&#125;px` &#125;&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;slot :item=&quot;item&quot; :index=&quot;item.index&quot; /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot; generic=&quot;T&quot;&gt;</span><br><span class="line">/**</span><br><span class="line"> * 虚拟滚动列表组件</span><br><span class="line"> * @description 用于渲染大量数据的高性能列表组件</span><br><span class="line"> */</span><br><span class="line">import &#123; ref, computed, onMounted, onUnmounted &#125; from &#x27;vue&#x27;;</span><br><span class="line"></span><br><span class="line">interface VirtualListProps&lt;T&gt; &#123;</span><br><span class="line">  items: T[];                    // 列表数据</span><br><span class="line">  itemHeight: number;            // 每项高度</span><br><span class="line">  height: number;                // 容器高度</span><br><span class="line">  buffer?: number;               // 缓冲区大小</span><br><span class="line">  keyField?: keyof T;            // 唯一键字段</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const props = withDefaults(defineProps&lt;VirtualListProps&lt;T&gt;&gt;(), &#123;</span><br><span class="line">  buffer: 5,</span><br><span class="line">  keyField: &#x27;id&#x27; as keyof T,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 容器引用</span><br><span class="line">const containerRef = ref&lt;HTMLElement&gt;();</span><br><span class="line"></span><br><span class="line">// 滚动位置</span><br><span class="line">const scrollTop = ref(0);</span><br><span class="line"></span><br><span class="line">// 计算总高度</span><br><span class="line">const totalHeight = computed(() =&gt; props.items.length * props.itemHeight);</span><br><span class="line"></span><br><span class="line">// 计算可见区域的起始和结束索引</span><br><span class="line">const visibleRange = computed(() =&gt; &#123;</span><br><span class="line">  const containerHeight = props.height;</span><br><span class="line">  const start = Math.floor(scrollTop.value / props.itemHeight);</span><br><span class="line">  const end = Math.min(</span><br><span class="line">    start + Math.ceil(containerHeight / props.itemHeight),</span><br><span class="line">    props.items.length</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  return &#123;</span><br><span class="line">    start: Math.max(0, start - props.buffer),</span><br><span class="line">    end: Math.min(props.items.length, end + props.buffer),</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 计算可见项目</span><br><span class="line">const visibleItems = computed(() =&gt; &#123;</span><br><span class="line">  const &#123; start, end &#125; = visibleRange.value;</span><br><span class="line">  return props.items.slice(start, end).map((item, index) =&gt; (&#123;</span><br><span class="line">    ...item,</span><br><span class="line">    index: start + index,</span><br><span class="line">  &#125;));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 计算偏移量</span><br><span class="line">const offsetY = computed(() =&gt; &#123;</span><br><span class="line">  return visibleRange.value.start * props.itemHeight;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 获取项目唯一键</span><br><span class="line"> * @param item 列表项</span><br><span class="line"> * @returns 唯一键值</span><br><span class="line"> */</span><br><span class="line">const getItemKey = (item: T &amp; &#123; index: number &#125;) =&gt; &#123;</span><br><span class="line">  return item[props.keyField] || item.index;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 处理滚动事件</span><br><span class="line"> * @param event 滚动事件</span><br><span class="line"> * @description 更新滚动位置并触发重新计算</span><br><span class="line"> */</span><br><span class="line">const handleScroll = (event: Event) =&gt; &#123;</span><br><span class="line">  const target = event.target as HTMLElement;</span><br><span class="line">  scrollTop.value = target.scrollTop;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// 防抖处理滚动事件</span><br><span class="line">let scrollTimer: number | null = null;</span><br><span class="line">const debouncedScroll = (event: Event) =&gt; &#123;</span><br><span class="line">  if (scrollTimer) &#123;</span><br><span class="line">    clearTimeout(scrollTimer);</span><br><span class="line">  &#125;</span><br><span class="line">  scrollTimer = setTimeout(() =&gt; &#123;</span><br><span class="line">    handleScroll(event);</span><br><span class="line">  &#125;, 16); // 约 60fps</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">  if (containerRef.value) &#123;</span><br><span class="line">    containerRef.value.addEventListener(&#x27;scroll&#x27;, debouncedScroll, &#123;</span><br><span class="line">      passive: true,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">onUnmounted(() =&gt; &#123;</span><br><span class="line">  if (containerRef.value) &#123;</span><br><span class="line">    containerRef.value.removeEventListener(&#x27;scroll&#x27;, debouncedScroll);</span><br><span class="line">  &#125;</span><br><span class="line">  if (scrollTimer) &#123;</span><br><span class="line">    clearTimeout(scrollTimer);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.virtual-list &#123;</span><br><span class="line">  position: relative;</span><br><span class="line">  overflow-y: auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.virtual-list-phantom &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: 0;</span><br><span class="line">  left: 0;</span><br><span class="line">  right: 0;</span><br><span class="line">  z-index: -1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.virtual-list-content &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: 0;</span><br><span class="line">  left: 0;</span><br><span class="line">  right: 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.virtual-list-item &#123;</span><br><span class="line">  box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="测试策略"><a href="#测试策略" class="headerlink" title="测试策略"></a>测试策略</h2><h3 id="1-单元测试配置"><a href="#1-单元测试配置" class="headerlink" title="1. 单元测试配置"></a>1. 单元测试配置</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tests/unit/components/Button.test.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Button 组件单元测试</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 测试 Button 组件的各种功能和状态</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> &#123; describe, it, expect, vi &#125; <span class="keyword">from</span> <span class="string">&#x27;vitest&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; mount &#125; <span class="keyword">from</span> <span class="string">&#x27;@vue/test-utils&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Button</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/base/Button/Button.vue&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;Button 组件&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;应该正确渲染默认按钮&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Button</span>, &#123;</span><br><span class="line">      <span class="attr">slots</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: <span class="string">&#x27;点击我&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">text</span>()).<span class="title function_">toBe</span>(<span class="string">&#x27;点击我&#x27;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&#x27;btn&#x27;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&#x27;btn--primary&#x27;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&#x27;btn--medium&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;应该正确处理点击事件&#x27;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> handleClick = vi.<span class="title function_">fn</span>();</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Button</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">onClick</span>: handleClick,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">slots</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: <span class="string">&#x27;点击我&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> wrapper.<span class="title function_">trigger</span>(<span class="string">&#x27;click&#x27;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(handleClick).<span class="title function_">toHaveBeenCalledTimes</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;禁用状态下不应该触发点击事件&#x27;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> handleClick = vi.<span class="title function_">fn</span>();</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Button</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">disabled</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">onClick</span>: handleClick,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">slots</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: <span class="string">&#x27;点击我&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> wrapper.<span class="title function_">trigger</span>(<span class="string">&#x27;click&#x27;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(handleClick).<span class="property">not</span>.<span class="title function_">toHaveBeenCalled</span>();</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&#x27;btn--disabled&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;加载状态下应该显示加载图标&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">Button</span>, &#123;</span><br><span class="line">      <span class="attr">props</span>: &#123;</span><br><span class="line">        <span class="attr">loading</span>: <span class="literal">true</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">slots</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: <span class="string">&#x27;点击我&#x27;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">classes</span>()).<span class="title function_">toContain</span>(<span class="string">&#x27;btn--loading&#x27;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">findComponent</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;Icon&#x27;</span> &#125;).<span class="title function_">exists</span>()).<span class="title function_">toBe</span>(<span class="literal">true</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="2-集成测试示例"><a href="#2-集成测试示例" class="headerlink" title="2. 集成测试示例"></a>2. 集成测试示例</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tests/integration/user-management.test.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用户管理集成测试</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 测试用户管理模块的完整流程</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> &#123; describe, it, expect, beforeEach, vi &#125; <span class="keyword">from</span> <span class="string">&#x27;vitest&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; mount &#125; <span class="keyword">from</span> <span class="string">&#x27;@vue/test-utils&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createPinia, setActivePinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">UserList</span> <span class="keyword">from</span> <span class="string">&#x27;@/modules/user/pages/UserList.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useUserStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/modules/user/stores/UserStore&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模拟 API 响应</span></span><br><span class="line">vi.<span class="title function_">mock</span>(<span class="string">&#x27;@/infrastructure/http&#x27;</span>, <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">  <span class="title class_">ApiClient</span>: vi.<span class="title function_">fn</span>().<span class="title function_">mockImplementation</span>(<span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">get</span>: vi.<span class="title function_">fn</span>().<span class="title function_">mockResolvedValue</span>(&#123;</span><br><span class="line">      <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">code</span>: <span class="number">200</span>,</span><br><span class="line">        <span class="attr">data</span>: [</span><br><span class="line">          &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;张三&#x27;</span>, <span class="attr">email</span>: <span class="string">&#x27;zhangsan@example.com&#x27;</span> &#125;,</span><br><span class="line">          &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;李四&#x27;</span>, <span class="attr">email</span>: <span class="string">&#x27;lisi@example.com&#x27;</span> &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;)),</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;用户管理集成测试&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="attr">router</span>: <span class="built_in">any</span>;</span><br><span class="line">  <span class="keyword">let</span> <span class="attr">pinia</span>: <span class="built_in">any</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">beforeEach</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    pinia = <span class="title function_">createPinia</span>();</span><br><span class="line">    <span class="title function_">setActivePinia</span>(pinia);</span><br><span class="line"></span><br><span class="line">    router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">      <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(),</span><br><span class="line">      <span class="attr">routes</span>: [</span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">&#x27;/users&#x27;</span>, <span class="attr">component</span>: <span class="title class_">UserList</span> &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;应该正确加载和显示用户列表&#x27;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">UserList</span>, &#123;</span><br><span class="line">      <span class="attr">global</span>: &#123;</span><br><span class="line">        <span class="attr">plugins</span>: [pinia, router],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> userStore = <span class="title function_">useUserStore</span>();</span><br><span class="line">    <span class="keyword">await</span> userStore.<span class="title function_">loadUsers</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 等待组件更新</span></span><br><span class="line">    <span class="keyword">await</span> wrapper.<span class="property">vm</span>.$nextTick();</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(userStore.<span class="property">users</span>).<span class="title function_">toHaveLength</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">text</span>()).<span class="title function_">toContain</span>(<span class="string">&#x27;张三&#x27;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">text</span>()).<span class="title function_">toContain</span>(<span class="string">&#x27;李四&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;应该正确处理用户搜索&#x27;</span>, <span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> wrapper = <span class="title function_">mount</span>(<span class="title class_">UserList</span>, &#123;</span><br><span class="line">      <span class="attr">global</span>: &#123;</span><br><span class="line">        <span class="attr">plugins</span>: [pinia, router],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> searchInput = wrapper.<span class="title function_">find</span>(<span class="string">&#x27;[data-testid=&quot;search-input&quot;]&#x27;</span>);</span><br><span class="line">    <span class="keyword">await</span> searchInput.<span class="title function_">setValue</span>(<span class="string">&#x27;张三&#x27;</span>);</span><br><span class="line">    <span class="keyword">await</span> searchInput.<span class="title function_">trigger</span>(<span class="string">&#x27;input&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 等待搜索结果</span></span><br><span class="line">    <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">300</span>));</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">text</span>()).<span class="title function_">toContain</span>(<span class="string">&#x27;张三&#x27;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(wrapper.<span class="title function_">text</span>()).<span class="property">not</span>.<span class="title function_">toContain</span>(<span class="string">&#x27;李四&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="部署与监控"><a href="#部署与监控" class="headerlink" title="部署与监控"></a>部署与监控</h2><h3 id="1-Docker-容器化部署"><a href="#1-Docker-容器化部署" class="headerlink" title="1. Docker 容器化部署"></a>1. Docker 容器化部署</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Dockerfile</span></span><br><span class="line"><span class="comment"># 多阶段构建，优化镜像大小</span></span><br><span class="line"><span class="keyword">FROM</span> node:<span class="number">18</span>-alpine AS builder</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置工作目录</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制 package 文件</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> package*.json ./</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> pnpm-lock.yaml ./</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 pnpm</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> npm install -g pnpm</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装依赖</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pnpm install --frozen-lockfile</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制源代码</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . .</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建应用</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pnpm build</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生产阶段</span></span><br><span class="line"><span class="keyword">FROM</span> nginx:alpine</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制构建产物</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --from=builder /app/dist /usr/share/nginx/html</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制 nginx 配置</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> nginx.conf /etc/nginx/nginx.conf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 暴露端口</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动 nginx</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;nginx&quot;</span>, <span class="string">&quot;-g&quot;</span>, <span class="string">&quot;daemon off;&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<h3 id="2-性能监控配置"><a href="#2-性能监控配置" class="headerlink" title="2. 性能监控配置"></a>2. 性能监控配置</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/utils/performance-monitor.ts</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 性能监控工具</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 监控应用性能指标并上报数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">PerformanceMetrics</span> &#123;</span><br><span class="line">  <span class="attr">fcp</span>: <span class="built_in">number</span>;      <span class="comment">// First Contentful Paint</span></span><br><span class="line">  <span class="attr">lcp</span>: <span class="built_in">number</span>;      <span class="comment">// Largest Contentful Paint</span></span><br><span class="line">  <span class="attr">fid</span>: <span class="built_in">number</span>;      <span class="comment">// First Input Delay</span></span><br><span class="line">  <span class="attr">cls</span>: <span class="built_in">number</span>;      <span class="comment">// Cumulative Layout Shift</span></span><br><span class="line">  <span class="attr">ttfb</span>: <span class="built_in">number</span>;     <span class="comment">// Time to First Byte</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PerformanceMonitor</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">metrics</span>: <span class="title class_">Partial</span>&lt;<span class="title class_">PerformanceMetrics</span>&gt; = &#123;&#125;;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">observer</span>: <span class="title class_">PerformanceObserver</span> | <span class="literal">null</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 初始化性能监控</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@description</span> 设置各种性能指标的监控</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">init</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">observeWebVitals</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">observeNavigation</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">observeResources</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 监控 Web Vitals 指标</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@description</span> 监控 FCP、LCP、FID、CLS 等核心指标</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">observeWebVitals</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&#x27;PerformanceObserver&#x27;</span> <span class="keyword">in</span> <span class="variable language_">window</span>) &#123;</span><br><span class="line">      <span class="comment">// 监控 FCP 和 LCP</span></span><br><span class="line">      <span class="keyword">const</span> paintObserver = <span class="keyword">new</span> <span class="title class_">PerformanceObserver</span>(<span class="function">(<span class="params">list</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> entry <span class="keyword">of</span> list.<span class="title function_">getEntries</span>()) &#123;</span><br><span class="line">          <span class="keyword">if</span> (entry.<span class="property">name</span> === <span class="string">&#x27;first-contentful-paint&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">metrics</span>.<span class="property">fcp</span> = entry.<span class="property">startTime</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      paintObserver.<span class="title function_">observe</span>(&#123; <span class="attr">entryTypes</span>: [<span class="string">&#x27;paint&#x27;</span>] &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 监控 LCP</span></span><br><span class="line">      <span class="keyword">const</span> lcpObserver = <span class="keyword">new</span> <span class="title class_">PerformanceObserver</span>(<span class="function">(<span class="params">list</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> entries = list.<span class="title function_">getEntries</span>();</span><br><span class="line">        <span class="keyword">const</span> lastEntry = entries[entries.<span class="property">length</span> - <span class="number">1</span>];</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">metrics</span>.<span class="property">lcp</span> = lastEntry.<span class="property">startTime</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">      lcpObserver.<span class="title function_">observe</span>(&#123; <span class="attr">entryTypes</span>: [<span class="string">&#x27;largest-contentful-paint&#x27;</span>] &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 监控 FID</span></span><br><span class="line">      <span class="keyword">const</span> fidObserver = <span class="keyword">new</span> <span class="title class_">PerformanceObserver</span>(<span class="function">(<span class="params">list</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> entry <span class="keyword">of</span> list.<span class="title function_">getEntries</span>()) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">metrics</span>.<span class="property">fid</span> = entry.<span class="property">processingStart</span> - entry.<span class="property">startTime</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      fidObserver.<span class="title function_">observe</span>(&#123; <span class="attr">entryTypes</span>: [<span class="string">&#x27;first-input&#x27;</span>] &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 监控 CLS</span></span><br><span class="line">      <span class="keyword">const</span> clsObserver = <span class="keyword">new</span> <span class="title class_">PerformanceObserver</span>(<span class="function">(<span class="params">list</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> clsValue = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> entry <span class="keyword">of</span> list.<span class="title function_">getEntries</span>()) &#123;</span><br><span class="line">          <span class="keyword">if</span> (!entry.<span class="property">hadRecentInput</span>) &#123;</span><br><span class="line">            clsValue += entry.<span class="property">value</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">metrics</span>.<span class="property">cls</span> = clsValue;</span><br><span class="line">      &#125;);</span><br><span class="line">      clsObserver.<span class="title function_">observe</span>(&#123; <span class="attr">entryTypes</span>: [<span class="string">&#x27;layout-shift&#x27;</span>] &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 监控导航性能</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@description</span> 监控页面加载时间等导航相关指标</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">observeNavigation</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> navigation = performance.<span class="title function_">getEntriesByType</span>(<span class="string">&#x27;navigation&#x27;</span>)[<span class="number">0</span>] <span class="keyword">as</span> <span class="title class_">PerformanceNavigationTiming</span>;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">metrics</span>.<span class="property">ttfb</span> = navigation.<span class="property">responseStart</span> - navigation.<span class="property">requestStart</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 监控资源加载性能</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@description</span> 监控静态资源的加载时间</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">observeResources</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> resourceObserver = <span class="keyword">new</span> <span class="title class_">PerformanceObserver</span>(<span class="function">(<span class="params">list</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">const</span> entry <span class="keyword">of</span> list.<span class="title function_">getEntries</span>()) &#123;</span><br><span class="line">        <span class="keyword">const</span> resource = entry <span class="keyword">as</span> <span class="title class_">PerformanceResourceTiming</span>;</span><br><span class="line">        <span class="keyword">if</span> (resource.<span class="property">duration</span> &gt; <span class="number">1000</span>) &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">`慢资源加载: <span class="subst">$&#123;resource.name&#125;</span>, 耗时: <span class="subst">$&#123;resource.duration&#125;</span>ms`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    resourceObserver.<span class="title function_">observe</span>(&#123; <span class="attr">entryTypes</span>: [<span class="string">&#x27;resource&#x27;</span>] &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 上报性能数据</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@description</span> 将收集的性能数据发送到监控服务</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">reportMetrics</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/api/performance&#x27;</span>, &#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">        <span class="attr">headers</span>: &#123;</span><br><span class="line">          <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">          <span class="attr">metrics</span>: <span class="variable language_">this</span>.<span class="property">metrics</span>,</span><br><span class="line">          <span class="attr">userAgent</span>: navigator.<span class="property">userAgent</span>,</span><br><span class="line">          <span class="attr">url</span>: <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>,</span><br><span class="line">          <span class="attr">timestamp</span>: <span class="title class_">Date</span>.<span class="title function_">now</span>(),</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;性能数据上报失败:&#x27;</span>, error);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 获取当前性能指标</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns</span> 性能指标对象</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">getMetrics</span>(): <span class="title class_">Partial</span>&lt;<span class="title class_">PerformanceMetrics</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; ...<span class="variable language_">this</span>.<span class="property">metrics</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> performanceMonitor = <span class="keyword">new</span> <span class="title class_">PerformanceMonitor</span>();</span><br></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文深入探讨了 Vue 3 企业级应用架构设计的各个方面，从基础的分层架构设计到具体的技术实现，涵盖了以下核心内容：</p>
<h3 id="核心特性"><a href="#核心特性" class="headerlink" title="核心特性"></a>核心特性</h3><ol>
<li><strong>分层架构设计</strong> - 清晰的表现层、业务层、数据层和基础设施层划分</li>
<li><strong>模块化开发</strong> - 基于功能模块的代码组织和管理策略</li>
<li><strong>TypeScript 集成</strong> - 完整的类型安全和开发体验优化</li>
<li><strong>状态管理架构</strong> - 基于 Pinia 的企业级状态管理方案</li>
<li><strong>组件架构设计</strong> - 可复用的基础组件库和高阶组件模式</li>
<li><strong>路由架构</strong> - 模块化路由配置和权限控制系统</li>
<li><strong>性能优化</strong> - 懒加载、虚拟滚动等性能优化策略</li>
<li><strong>测试策略</strong> - 完整的单元测试和集成测试方案</li>
<li><strong>部署监控</strong> - 容器化部署和性能监控体系</li>
</ol>
<h3 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h3><ol>
<li><strong>代码组织</strong> - 采用模块化和分层的代码组织方式</li>
<li><strong>类型安全</strong> - 充分利用 TypeScript 提供类型安全保障</li>
<li><strong>性能优化</strong> - 合理使用懒加载、代码分割等优化技术</li>
<li><strong>测试覆盖</strong> - 建立完善的测试体系保证代码质量</li>
<li><strong>监控体系</strong> - 建立性能监控和错误追踪机制</li>
</ol>
<p>Vue 3 的 Composition API、更好的 TypeScript 支持和性能优化，使其完全具备了构建大型企业级应用的能力。通过合理的架构设计和最佳实践的应用，可以构建出高质量、可维护、可扩展的企业级前端应用。</p>

                    
                </div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                            <ul class="post-tags-box border-box">
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/Vue3/">Vue3</a>
                                    </li>
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/TypeScript/">TypeScript</a>
                                    </li>
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/">架构设计</a>
                                    </li>
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%BA%94%E7%94%A8/">企业级应用</a>
                                    </li>
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/%E6%A8%A1%E5%9D%97%E5%8C%96%E5%BC%80%E5%8F%91/">模块化开发</a>
                                    </li>
                                
                            </ul>
                        
                    </div>
                    <div>
                        
                    </div>
                </div>

                

                
                    <div class="post-nav border-box">
                        
                            <div class="prev-post">
                                <a class="prev"
                                   rel="prev"
                                   href="/2023/mysql/mysql-replication-setup-guide/"
                                   title="MySQL主从复制配置实战：高可用架构搭建指南"
                                >
                                    <span class="left arrow-icon flex-center">
                                        <i class="fas fa-chevron-left"></i>
                                    </span>
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">MySQL主从复制配置实战：高可用架构搭建指南</span>
                                        <span class="post-nav-item">上一篇</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="next-post">
                                <a class="next"
                                   rel="next"
                                   href="/2023/thinkphp/thinkphp6-cache-performance-optimization/"
                                   title="ThinkPHP6/8 缓存系统与性能优化实战指南"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">ThinkPHP6/8 缓存系统与性能优化实战指南</span>
                                        <span class="post-nav-item">下一篇</span>
                                    </span>
                                    <span class="right arrow-icon flex-center">
                                        <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    






                
            </div>
        </div>

        
            <div class="pc-post-toc right-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Vue-3-%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%BA%94%E7%94%A8%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-text">Vue 3 企业级应用架构设计与最佳实践</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%BA%94%E7%94%A8%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99"><span class="nav-text">企业级应用架构设计原则</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="nav-text">1. 分层架构设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%A8%A1%E5%9D%97%E5%8C%96%E5%BC%80%E5%8F%91%E7%AD%96%E7%95%A5"><span class="nav-text">2. 模块化开发策略</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-TypeScript-%E9%9B%86%E6%88%90%E4%B8%8E%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8"><span class="nav-text">3. TypeScript 集成与类型安全</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="nav-text">状态管理架构设计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Pinia-%E4%BC%81%E4%B8%9A%E7%BA%A7%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86"><span class="nav-text">1. Pinia 企业级状态管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E7%8A%B6%E6%80%81%E6%8C%81%E4%B9%85%E5%8C%96%E4%B8%8E%E5%90%8C%E6%AD%A5"><span class="nav-text">2. 状态持久化与同步</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%84%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="nav-text">组件架构设计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6%E5%BA%93%E6%9E%B6%E6%9E%84"><span class="nav-text">1. 基础组件库架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%E6%A8%A1%E5%BC%8F"><span class="nav-text">2. 高阶组件模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="nav-text">路由架构设计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%A8%A1%E5%9D%97%E5%8C%96%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE"><span class="nav-text">1. 模块化路由配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E8%B7%AF%E7%94%B1%E5%AE%88%E5%8D%AB%E4%B8%8E%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6"><span class="nav-text">2. 路由守卫与权限控制</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5"><span class="nav-text">性能优化策略</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E7%BB%84%E4%BB%B6%E6%87%92%E5%8A%A0%E8%BD%BD%E4%B8%8E%E4%BB%A3%E7%A0%81%E5%88%86%E5%89%B2"><span class="nav-text">1. 组件懒加载与代码分割</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E8%99%9A%E6%8B%9F%E6%BB%9A%E5%8A%A8%E4%BC%98%E5%8C%96"><span class="nav-text">2. 虚拟滚动优化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E7%AD%96%E7%95%A5"><span class="nav-text">测试策略</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E9%85%8D%E7%BD%AE"><span class="nav-text">1. 单元测试配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E9%9B%86%E6%88%90%E6%B5%8B%E8%AF%95%E7%A4%BA%E4%BE%8B"><span class="nav-text">2. 集成测试示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%9B%91%E6%8E%A7"><span class="nav-text">部署与监控</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Docker-%E5%AE%B9%E5%99%A8%E5%8C%96%E9%83%A8%E7%BD%B2"><span class="nav-text">1. Docker 容器化部署</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E9%85%8D%E7%BD%AE"><span class="nav-text">2. 性能监控配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-text">总结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E7%89%B9%E6%80%A7"><span class="nav-text">核心特性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-text">最佳实践</span></a></li></ol></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>
        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="copyright-info info-item">
    &copy;&nbsp;2025
    
            &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">Orion K</a>
        
    </div>


    
        
        <div class="deploy-info info-item">
            
            本站由 <span class="tooltip" data-tooltip-content="GitHub Pages"><img src="/images/brands/github.png"></span> 提供部署服务
            
        </div>
    

    

    
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            <div class="post-tools-container border-box">
    <ul class="post-tools-list border-box">
        <!-- PC encrypt again -->
        

        <!-- PC TOC show toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- PC go comment -->
        

        <!-- PC full screen -->
        <li class="tools-item flex-center full-screen">
            <i class="fa-solid fa-expand"></i>
        </li>
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <!-- toggle mode -->
        
            <li class="tools-item tool-toggle-theme-mode flex-center">
                <i class="fas fa-moon"></i>
            </li>
        

        <!-- rss -->
        

        <!-- to bottom -->
        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Vue-3-%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%BA%94%E7%94%A8%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-text">Vue 3 企业级应用架构设计与最佳实践</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%BA%94%E7%94%A8%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99"><span class="nav-text">企业级应用架构设计原则</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="nav-text">1. 分层架构设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%A8%A1%E5%9D%97%E5%8C%96%E5%BC%80%E5%8F%91%E7%AD%96%E7%95%A5"><span class="nav-text">2. 模块化开发策略</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-TypeScript-%E9%9B%86%E6%88%90%E4%B8%8E%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8"><span class="nav-text">3. TypeScript 集成与类型安全</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="nav-text">状态管理架构设计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Pinia-%E4%BC%81%E4%B8%9A%E7%BA%A7%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86"><span class="nav-text">1. Pinia 企业级状态管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E7%8A%B6%E6%80%81%E6%8C%81%E4%B9%85%E5%8C%96%E4%B8%8E%E5%90%8C%E6%AD%A5"><span class="nav-text">2. 状态持久化与同步</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%84%E4%BB%B6%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="nav-text">组件架构设计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6%E5%BA%93%E6%9E%B6%E6%9E%84"><span class="nav-text">1. 基础组件库架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%E6%A8%A1%E5%BC%8F"><span class="nav-text">2. 高阶组件模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="nav-text">路由架构设计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%A8%A1%E5%9D%97%E5%8C%96%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE"><span class="nav-text">1. 模块化路由配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E8%B7%AF%E7%94%B1%E5%AE%88%E5%8D%AB%E4%B8%8E%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6"><span class="nav-text">2. 路由守卫与权限控制</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5"><span class="nav-text">性能优化策略</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E7%BB%84%E4%BB%B6%E6%87%92%E5%8A%A0%E8%BD%BD%E4%B8%8E%E4%BB%A3%E7%A0%81%E5%88%86%E5%89%B2"><span class="nav-text">1. 组件懒加载与代码分割</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E8%99%9A%E6%8B%9F%E6%BB%9A%E5%8A%A8%E4%BC%98%E5%8C%96"><span class="nav-text">2. 虚拟滚动优化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E7%AD%96%E7%95%A5"><span class="nav-text">测试策略</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E9%85%8D%E7%BD%AE"><span class="nav-text">1. 单元测试配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E9%9B%86%E6%88%90%E6%B5%8B%E8%AF%95%E7%A4%BA%E4%BE%8B"><span class="nav-text">2. 集成测试示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%83%A8%E7%BD%B2%E4%B8%8E%E7%9B%91%E6%8E%A7"><span class="nav-text">部署与监控</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Docker-%E5%AE%B9%E5%99%A8%E5%8C%96%E9%83%A8%E7%BD%B2"><span class="nav-text">1. Docker 容器化部署</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E9%85%8D%E7%BD%AE"><span class="nav-text">2. 性能监控配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-text">总结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E7%89%B9%E6%80%A7"><span class="nav-text">核心特性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-text">最佳实践</span></a></li></ol></li></ol></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>





<!-- common js -->

<script src="/js/utils.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/toggle-theme.js"></script>

<script src="/js/code-block.js"></script>

<script src="/js/main.js"></script>

<script src="/js/libs/anime.min.js"></script>


<!-- local search -->

    
<script src="/js/local-search.js"></script>



<!-- lazyload -->


<div class="">
    <!-- home page -->
    

    <!-- post page -->
    
        <!-- post-helper -->
        
<script src="/js/post/post-helper.js"></script>


        <!-- toc -->
        
            
<script src="/js/post/toc.js"></script>

        

        <!-- copyright-info -->
        

        <!-- share -->
        
    

    <!-- categories page -->
    

    <!-- links page -->
    

    <!-- photos page -->
    

    <!-- tools page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



</body>
</html>
