<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="Orion K">
    
    <title>
        
            PHP正则表达式实战指南：模式匹配与文本处理 |
        
        Orion K Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="/images/logo.svg">
    
    
<link rel="stylesheet" href="/font/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/font/css/regular.min.css">

    
<link rel="stylesheet" href="/font/css/solid.min.css">

    
<link rel="stylesheet" href="/font/css/brands.min.css">

    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.json"}
    KEEP.theme_config = {"base_info":{"primary_color":"#0066cc","title":"Orion K Blog","author":"Orion K","avatar":"/images/avatar.svg","logo":"/images/logo.svg","favicon":"/images/logo.svg"},"menu":{"home":"/                        || fa-solid fa-home","archives":"/archives            || fa-solid fa-box-archive","tags":"/tags                    || fa-solid fa-tags","categories":"/categories        || fa-solid fa-layer-group"},"first_screen":{"enable":false,"background_img":"/images/bg.svg","background_img_dark":"/images/bg.svg","description":"Keep writing and Keep loving.","hitokoto":false},"social_contact":{"enable":false,"links":{"github":null,"weixin":null,"qq":null,"weibo":null,"zhihu":null,"twitter":null,"x":null,"facebook":null,"email":null}},"scroll":{"progress_bar":false,"percent":false,"hide_header":true},"home":{"announcement":"欢迎来到 Orion K 的博客，这是一个分享互联网技术的博客。联系：wxmm686800@gmail.com","category":true,"tag":true,"post_datetime":"created"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":false,"min2read":false},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":false,"share":false,"reward":{"enable":false,"img_link":null,"text":null,"icon":null}},"code_block":{"tools":{"enable":false,"style":"default"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":false,"site_uv":false,"site_pv":false,"page_pv":false}},"local_search":{"enable":true,"preload":true},"comment":{"enable":false,"use":"valine","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.39"},"waline":{"server_url":null,"reaction":false,"version":"3.3.2"},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false},"artalk":{"server":null},"disqus":{"shortname":null}},"rss":{"enable":false},"lazyload":{"enable":false},"cdn":{"enable":false,"provider":"cdnjs"},"pjax":{"enable":false},"footer":{"since":2025,"word_count":false,"site_deploy":{"enable":true,"provider":"github","url":null},"record":{"enable":false,"list":[{"code":null,"link":null}]}},"inject":{"enable":false,"css":[null],"js":[null]},"root":"","source_data":{},"version":"4.2.5"}
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"}
    KEEP.language_code_block = {"copy":"复制代码","copied":"已复制","fold":"折叠代码块","folded":"已折叠"}
    KEEP.language_copy_copyright = {"copy":"复制版权信息","copied":"已复制","title":"原文标题","author":"原文作者","link":"原文链接"}
  </script>
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
</div>



<main class="page-container border-box">
    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left flex-start border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="/images/logo.svg">
                </a>
            
            <a class="site-name border-box" href="/">
               Orion K Blog
            </a>
        </div>

        <div class="right border-box">
            <div class="pc border-box">
                <ul class="menu-list border-box">
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-home"></i>
                                
                                首页
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/archives">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-box-archive"></i>
                                
                                归档
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/tags">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-tags"></i>
                                
                                标签
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/categories">
                                
                                    <i class="menu-text-color menu-icon fa-solid fa-layer-group"></i>
                                
                                分类
                                
                            </a>
                            
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="menu-text-color fas search fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile border-box flex-start">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list border-box">
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-home"></i>
                                </span>
                            
                            首页
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/archives">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-box-archive"></i>
                                </span>
                            
                            归档
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/tags">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-tags"></i>
                                </span>
                            
                            标签
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/categories">
                            
                                <span class="menu-icon-wrap border-box flex-center">
                                    <i class="drawer-menu-text-color menu-icon fa-solid fa-layer-group"></i>
                                </span>
                            
                            分类
                        </a>
                        
                    </label>
                    
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">
                

                    
<div class="fade-in-down-animation">
    <div class="post-page-container border-box">
        <div class="post-content-container border-box">
            

            <div class="post-content-bottom border-box">
                
                    <div class="post-title">
                        PHP正则表达式实战指南：模式匹配与文本处理
                    </div>
                

                
                    <div class="post-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="/images/avatar.svg">
                            </div>
                        
                        <div class="info-box">
                            <div class="author border-box">
                                <span class="name">Orion K</span>
                                
                                    <span class="author-badge">Lv6</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="post-meta-info-container border-box post">
    <div class="post-meta-info border-box">
        

        
            <span class="meta-info-item post-create-date">
                <i class="icon fa-solid fa-calendar-plus"></i>&nbsp;
                <span class="datetime">2023-07-10 16:45:00</span>
            </span>
        

        
            <span class="meta-info-item post-category border-box"><i class="icon fas fa-folder"></i>&nbsp;
                <ul class="post-category-ul">
                    
                            <li class="category-item"><a href="/categories/php/">php</a></li>
                        
                    
                </ul>
            </span>
        

        
            <span class="post-tag meta-info-item border-box">
                <ul class="post-tag-ul">
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">正则表达式</a></li>
                        
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86/">文本处理</a></li>
                        
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/">模式匹配</a></li>
                        
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/PHP%E5%9F%BA%E7%A1%80/">PHP基础</a></li>
                        
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81/">数据验证</a></li>
                        
                    
                </ul>
            </span>
        

        
        
        
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="post-content keep-markdown-body ">
                    

                    
                         <h1 id="PHP正则表达式实战指南：模式匹配与文本处理"><a href="#PHP正则表达式实战指南：模式匹配与文本处理" class="headerlink" title="PHP正则表达式实战指南：模式匹配与文本处理"></a>PHP正则表达式实战指南：模式匹配与文本处理</h1><p>正则表达式是处理文本的强大工具，在数据验证、文本解析和内容提取中发挥着重要作用。作为PHP开发者，掌握正则表达式能大大提高我们处理字符串的效率。本文将分享一些实用的正则表达式技巧和最佳实践。</p>
<h2 id="正则表达式基础"><a href="#正则表达式基础" class="headerlink" title="正则表达式基础"></a>正则表达式基础</h2><h3 id="1-基本语法和函数"><a href="#1-基本语法和函数" class="headerlink" title="1. 基本语法和函数"></a>1. 基本语法和函数</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 正则表达式基础示例</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;=== 正则表达式基础 ===\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 基本匹配函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">demonstrateBasicFunctions</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$text</span> = <span class="string">&quot;Hello World! My email is john@example.com and phone is 13812345678&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// preg_match - 执行匹配，返回匹配次数</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=== preg_match 示例 ===\n&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 匹配邮箱</span></span><br><span class="line">    <span class="variable">$emailPattern</span> = <span class="string">&#x27;/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]&#123;2,&#125;/&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$emailPattern</span>, <span class="variable">$text</span>, <span class="variable">$matches</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;找到邮箱: &quot;</span> . <span class="variable">$matches</span>[<span class="number">0</span>] . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 匹配手机号</span></span><br><span class="line">    <span class="variable">$phonePattern</span> = <span class="string">&#x27;/1[3-9]\d&#123;9&#125;/&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$phonePattern</span>, <span class="variable">$text</span>, <span class="variable">$matches</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;找到手机号: &quot;</span> . <span class="variable">$matches</span>[<span class="number">0</span>] . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// preg_match_all - 执行全局匹配</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;\n=== preg_match_all 示例 ===\n&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$multiText</span> = <span class="string">&quot;联系方式: john@example.com, jane@test.com, admin@site.org&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$emailPattern</span>, <span class="variable">$multiText</span>, <span class="variable">$matches</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;找到 &quot;</span> . <span class="title function_ invoke__">count</span>(<span class="variable">$matches</span>[<span class="number">0</span>]) . <span class="string">&quot; 个邮箱:\n&quot;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$matches</span>[<span class="number">0</span>] <span class="keyword">as</span> <span class="variable">$email</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;- <span class="subst">$email</span>\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// preg_replace - 执行替换</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;\n=== preg_replace 示例 ===\n&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$sensitiveText</span> = <span class="string">&quot;我的手机号是13812345678，邮箱是john@example.com&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 隐藏手机号中间4位</span></span><br><span class="line">    <span class="variable">$hiddenPhone</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/(1[3-9]\d)(\d&#123;4&#125;)(\d&#123;4&#125;)/&#x27;</span>, <span class="string">&#x27;$1****$3&#x27;</span>, <span class="variable">$sensitiveText</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;隐藏手机号: <span class="subst">$hiddenPhone</span>\n&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 隐藏邮箱用户名部分</span></span><br><span class="line">    <span class="variable">$hiddenEmail</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/([a-zA-Z0-9._%+-]&#123;1,3&#125;)[a-zA-Z0-9._%+-]*@/&#x27;</span>, <span class="string">&#x27;$1***@&#x27;</span>, <span class="variable">$hiddenPhone</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;隐藏邮箱: <span class="subst">$hiddenEmail</span>\n&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// preg_split - 分割字符串</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;\n=== preg_split 示例 ===\n&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$csvData</span> = <span class="string">&quot;张三,25,北京;李四,30,上海;王五,28,广州&quot;</span>;</span><br><span class="line">    <span class="variable">$records</span> = <span class="title function_ invoke__">preg_split</span>(<span class="string">&#x27;/[;,]/&#x27;</span>, <span class="variable">$csvData</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;分割结果: &quot;</span> . <span class="title function_ invoke__">json_encode</span>(<span class="variable">$records</span>, JSON_UNESCAPED_UNICODE) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 更复杂的分割</span></span><br><span class="line">    <span class="variable">$logEntry</span> = <span class="string">&quot;2023-07-10 16:45:30 [INFO] User login successful - IP: 192.168.1.100&quot;</span>;</span><br><span class="line">    <span class="variable">$logParts</span> = <span class="title function_ invoke__">preg_split</span>(<span class="string">&#x27;/\s+[-\[\]]\s*/&#x27;</span>, <span class="variable">$logEntry</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;日志分割: &quot;</span> . <span class="title function_ invoke__">json_encode</span>(<span class="variable">$logParts</span>, JSON_UNESCAPED_UNICODE) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">demonstrateBasicFunctions</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 正则表达式工具类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RegexHelper</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 常用正则模式</span></span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">PATTERNS</span> = [</span><br><span class="line">        <span class="string">&#x27;email&#x27;</span> =&gt; <span class="string">&#x27;/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]&#123;2,&#125;$/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;phone&#x27;</span> =&gt; <span class="string">&#x27;/^1[3-9]\d&#123;9&#125;$/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;idcard&#x27;</span> =&gt; <span class="string">&#x27;/^\d&#123;17&#125;[\dX]$/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;url&#x27;</span> =&gt; <span class="string">&#x27;/^https?:\/\/[^\s\/$.?#].[^\s]*$/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;ip&#x27;</span> =&gt; <span class="string">&#x27;/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.)&#123;3&#125;(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;date&#x27;</span> =&gt; <span class="string">&#x27;/^\d&#123;4&#125;-\d&#123;2&#125;-\d&#123;2&#125;$/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;time&#x27;</span> =&gt; <span class="string">&#x27;/^\d&#123;2&#125;:\d&#123;2&#125;:\d&#123;2&#125;$/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;chinese&#x27;</span> =&gt; <span class="string">&#x27;/^[\x&#123;4e00&#125;-\x&#123;9fa5&#125;]+$/u&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&amp;])[A-Za-z\d@$!%*?&amp;]&#123;8,&#125;$/&#x27;</span></span><br><span class="line">    ];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 验证输入</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">validate</span>(<span class="params"><span class="variable">$input</span>, <span class="variable">$pattern</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="built_in">self</span>::<span class="variable constant_">PATTERNS</span>[<span class="variable">$pattern</span>])) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="built_in">self</span>::<span class="variable constant_">PATTERNS</span>[<span class="variable">$pattern</span>], <span class="variable">$input</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>, <span class="variable">$input</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 提取信息</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">extract</span>(<span class="params"><span class="variable">$text</span>, <span class="variable">$pattern</span>, <span class="variable">$all</span> = <span class="literal">false</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="built_in">self</span>::<span class="variable constant_">PATTERNS</span>[<span class="variable">$pattern</span>])) &#123;</span><br><span class="line">            <span class="variable">$pattern</span> = <span class="built_in">self</span>::<span class="variable constant_">PATTERNS</span>[<span class="variable">$pattern</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$all</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$pattern</span>, <span class="variable">$text</span>, <span class="variable">$matches</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$matches</span>[<span class="number">0</span>] ?? [];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>, <span class="variable">$text</span>, <span class="variable">$matches</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$matches</span>[<span class="number">0</span>] ?? <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 清理文本</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">clean</span>(<span class="params"><span class="variable">$text</span>, <span class="variable">$pattern</span>, <span class="variable">$replacement</span> = <span class="string">&#x27;&#x27;</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$pattern</span>, <span class="variable">$replacement</span>, <span class="variable">$text</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 分割文本</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">split</span>(<span class="params"><span class="variable">$text</span>, <span class="variable">$pattern</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">preg_split</span>(<span class="variable">$pattern</span>, <span class="variable">$text</span>, -<span class="number">1</span>, PREG_SPLIT_NO_EMPTY);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 高亮匹配内容</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">highlight</span>(<span class="params"><span class="variable">$text</span>, <span class="variable">$pattern</span>, <span class="variable">$highlightTag</span> = <span class="string">&#x27;mark&#x27;</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$pattern</span>, <span class="string">&quot;&lt;<span class="subst">$highlightTag</span>&gt;<span class="subst">$0</span>&lt;/<span class="subst">$highlightTag</span>&gt;&quot;</span>, <span class="variable">$text</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用正则工具类</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n=== 正则工具类示例 ===\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 验证示例</span></span><br><span class="line"><span class="variable">$testData</span> = [</span><br><span class="line">    <span class="string">&#x27;email&#x27;</span> =&gt; <span class="string">&#x27;test@example.com&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;phone&#x27;</span> =&gt; <span class="string">&#x27;13812345678&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;url&#x27;</span> =&gt; <span class="string">&#x27;https://www.example.com&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;chinese&#x27;</span> =&gt; <span class="string">&#x27;中文测试&#x27;</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$testData</span> <span class="keyword">as</span> <span class="variable">$type</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">    <span class="variable">$isValid</span> = <span class="title class_">RegexHelper</span>::<span class="title function_ invoke__">validate</span>(<span class="variable">$value</span>, <span class="variable">$type</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$type</span> 验证 &#x27;<span class="subst">$value</span>&#x27;: &quot;</span> . (<span class="variable">$isValid</span> ? <span class="string">&#x27;通过&#x27;</span> : <span class="string">&#x27;失败&#x27;</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 提取示例</span></span><br><span class="line"><span class="variable">$contactText</span> = <span class="string">&quot;请联系我们：电话13812345678，邮箱support@example.com，网站https://www.example.com&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n提取信息:\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;手机号: &quot;</span> . (<span class="title class_">RegexHelper</span>::<span class="title function_ invoke__">extract</span>(<span class="variable">$contactText</span>, <span class="string">&#x27;phone&#x27;</span>) ?: <span class="string">&#x27;未找到&#x27;</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;邮箱: &quot;</span> . (<span class="title class_">RegexHelper</span>::<span class="title function_ invoke__">extract</span>(<span class="variable">$contactText</span>, <span class="string">&#x27;email&#x27;</span>) ?: <span class="string">&#x27;未找到&#x27;</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;网址: &quot;</span> . (<span class="title class_">RegexHelper</span>::<span class="title function_ invoke__">extract</span>(<span class="variable">$contactText</span>, <span class="string">&#x27;url&#x27;</span>) ?: <span class="string">&#x27;未找到&#x27;</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清理示例</span></span><br><span class="line"><span class="variable">$dirtyText</span> = <span class="string">&quot;这是一段包含&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;的文本和一些数字123456&quot;</span>;</span><br><span class="line"><span class="variable">$cleanText</span> = <span class="title class_">RegexHelper</span>::<span class="title function_ invoke__">clean</span>(<span class="variable">$dirtyText</span>, <span class="string">&#x27;/&lt;[^&gt;]*&gt;/&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n清理HTML标签: <span class="subst">$cleanText</span>\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$numbersOnly</span> = <span class="title class_">RegexHelper</span>::<span class="title function_ invoke__">clean</span>(<span class="variable">$dirtyText</span>, <span class="string">&#x27;/[^\d]/&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;只保留数字: <span class="subst">$numbersOnly</span>\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-高级模式匹配"><a href="#2-高级模式匹配" class="headerlink" title="2. 高级模式匹配"></a>2. 高级模式匹配</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 高级正则表达式模式</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;=== 高级模式匹配 ===\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AdvancedRegex</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 解析URL组件</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">parseUrl</span>(<span class="params"><span class="variable">$url</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$pattern</span> = <span class="string">&#x27;/^(https?):\/\/([^\/\s]+)(\/[^\s\?]*)?(\?[^\s#]*)?(#[^\s]*)?$/&#x27;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>, <span class="variable">$url</span>, <span class="variable">$matches</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> [</span><br><span class="line">                <span class="string">&#x27;full_url&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">0</span>],</span><br><span class="line">                <span class="string">&#x27;protocol&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">1</span>],</span><br><span class="line">                <span class="string">&#x27;domain&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">2</span>],</span><br><span class="line">                <span class="string">&#x27;path&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">3</span>] ?? <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;query&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">4</span>] ?? <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;fragment&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">5</span>] ?? <span class="string">&#x27;&#x27;</span></span><br><span class="line">            ];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 解析邮箱地址</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">parseEmail</span>(<span class="params"><span class="variable">$email</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$pattern</span> = <span class="string">&#x27;/^([a-zA-Z0-9._%+-]+)@([a-zA-Z0-9.-]+)\.([a-zA-Z]&#123;2,&#125;)$/&#x27;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>, <span class="variable">$email</span>, <span class="variable">$matches</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> [</span><br><span class="line">                <span class="string">&#x27;full_email&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">0</span>],</span><br><span class="line">                <span class="string">&#x27;username&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">1</span>],</span><br><span class="line">                <span class="string">&#x27;domain&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">2</span>],</span><br><span class="line">                <span class="string">&#x27;tld&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">3</span>]</span><br><span class="line">            ];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 提取HTML标签属性</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">extractHtmlAttributes</span>(<span class="params"><span class="variable">$html</span>, <span class="variable">$tag</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$pattern</span> = <span class="string">&quot;/&lt;<span class="subst">$tag</span>\s+([^&gt;]*)&gt;/i&quot;</span>;</span><br><span class="line">        <span class="variable">$results</span> = [];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$pattern</span>, <span class="variable">$html</span>, <span class="variable">$matches</span>)) &#123;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="variable">$matches</span>[<span class="number">1</span>] <span class="keyword">as</span> <span class="variable">$attributeString</span>) &#123;</span><br><span class="line">                <span class="variable">$attributes</span> = [];</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 解析属性</span></span><br><span class="line">                <span class="variable">$attrPattern</span> = <span class="string">&#x27;/(\w+)\s*=\s*[&quot;\&#x27;]([^&quot;\&#x27;]*)[&quot;\&#x27;]|(\w+)\s*=\s*([^\s&gt;]*)/&#x27;</span>;</span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$attrPattern</span>, <span class="variable">$attributeString</span>, <span class="variable">$attrMatches</span>, PREG_SET_ORDER)) &#123;</span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="variable">$attrMatches</span> <span class="keyword">as</span> <span class="variable">$attrMatch</span>) &#123;</span><br><span class="line">                        <span class="variable">$attrName</span> = <span class="variable">$attrMatch</span>[<span class="number">1</span>] ?: <span class="variable">$attrMatch</span>[<span class="number">3</span>];</span><br><span class="line">                        <span class="variable">$attrValue</span> = <span class="variable">$attrMatch</span>[<span class="number">2</span>] ?: <span class="variable">$attrMatch</span>[<span class="number">4</span>];</span><br><span class="line">                        <span class="variable">$attributes</span>[<span class="variable">$attrName</span>] = <span class="variable">$attrValue</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="variable">$results</span>[] = <span class="variable">$attributes</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$results</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 验证密码强度</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">validatePasswordStrength</span>(<span class="params"><span class="variable">$password</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$checks</span> = [</span><br><span class="line">            <span class="string">&#x27;length&#x27;</span> =&gt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$password</span>) &gt;= <span class="number">8</span>,</span><br><span class="line">            <span class="string">&#x27;lowercase&#x27;</span> =&gt; <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z]/&#x27;</span>, <span class="variable">$password</span>),</span><br><span class="line">            <span class="string">&#x27;uppercase&#x27;</span> =&gt; <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[A-Z]/&#x27;</span>, <span class="variable">$password</span>),</span><br><span class="line">            <span class="string">&#x27;digit&#x27;</span> =&gt; <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\d/&#x27;</span>, <span class="variable">$password</span>),</span><br><span class="line">            <span class="string">&#x27;special&#x27;</span> =&gt; <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[@$!%*?&amp;]/&#x27;</span>, <span class="variable">$password</span>),</span><br><span class="line">            <span class="string">&#x27;no_common&#x27;</span> =&gt; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^(password|123456|qwerty|admin)$/i&#x27;</span>, <span class="variable">$password</span>)</span><br><span class="line">        ];</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$score</span> = <span class="title function_ invoke__">array_sum</span>(<span class="variable">$checks</span>);</span><br><span class="line">        <span class="variable">$strength</span> = <span class="string">&#x27;weak&#x27;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$score</span> &gt;= <span class="number">5</span>) &#123;</span><br><span class="line">            <span class="variable">$strength</span> = <span class="string">&#x27;strong&#x27;</span>;</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (<span class="variable">$score</span> &gt;= <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="variable">$strength</span> = <span class="string">&#x27;medium&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="string">&#x27;score&#x27;</span> =&gt; <span class="variable">$score</span>,</span><br><span class="line">            <span class="string">&#x27;strength&#x27;</span> =&gt; <span class="variable">$strength</span>,</span><br><span class="line">            <span class="string">&#x27;checks&#x27;</span> =&gt; <span class="variable">$checks</span>,</span><br><span class="line">            <span class="string">&#x27;suggestions&#x27;</span> =&gt; <span class="built_in">self</span>::<span class="title function_ invoke__">getPasswordSuggestions</span>(<span class="variable">$checks</span>)</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取密码改进建议</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getPasswordSuggestions</span>(<span class="params"><span class="variable">$checks</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$suggestions</span> = [];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$checks</span>[<span class="string">&#x27;length&#x27;</span>]) &#123;</span><br><span class="line">            <span class="variable">$suggestions</span>[] = <span class="string">&#x27;密码长度至少8位&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$checks</span>[<span class="string">&#x27;lowercase&#x27;</span>]) &#123;</span><br><span class="line">            <span class="variable">$suggestions</span>[] = <span class="string">&#x27;添加小写字母&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$checks</span>[<span class="string">&#x27;uppercase&#x27;</span>]) &#123;</span><br><span class="line">            <span class="variable">$suggestions</span>[] = <span class="string">&#x27;添加大写字母&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$checks</span>[<span class="string">&#x27;digit&#x27;</span>]) &#123;</span><br><span class="line">            <span class="variable">$suggestions</span>[] = <span class="string">&#x27;添加数字&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$checks</span>[<span class="string">&#x27;special&#x27;</span>]) &#123;</span><br><span class="line">            <span class="variable">$suggestions</span>[] = <span class="string">&#x27;添加特殊字符(@$!%*?&amp;)&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$checks</span>[<span class="string">&#x27;no_common&#x27;</span>]) &#123;</span><br><span class="line">            <span class="variable">$suggestions</span>[] = <span class="string">&#x27;避免使用常见密码&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$suggestions</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 提取文本中的日期</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">extractDates</span>(<span class="params"><span class="variable">$text</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$patterns</span> = [</span><br><span class="line">            <span class="string">&#x27;yyyy-mm-dd&#x27;</span> =&gt; <span class="string">&#x27;/\b\d&#123;4&#125;-\d&#123;2&#125;-\d&#123;2&#125;\b/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;dd/mm/yyyy&#x27;</span> =&gt; <span class="string">&#x27;/\b\d&#123;2&#125;\/\d&#123;2&#125;\/\d&#123;4&#125;\b/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;mm-dd-yyyy&#x27;</span> =&gt; <span class="string">&#x27;/\b\d&#123;2&#125;-\d&#123;2&#125;-\d&#123;4&#125;\b/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;chinese&#x27;</span> =&gt; <span class="string">&#x27;/\b\d&#123;4&#125;年\d&#123;1,2&#125;月\d&#123;1,2&#125;日\b/u&#x27;</span></span><br><span class="line">        ];</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$dates</span> = [];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$patterns</span> <span class="keyword">as</span> <span class="variable">$format</span> =&gt; <span class="variable">$pattern</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$pattern</span>, <span class="variable">$text</span>, <span class="variable">$matches</span>)) &#123;</span><br><span class="line">                <span class="keyword">foreach</span> (<span class="variable">$matches</span>[<span class="number">0</span>] <span class="keyword">as</span> <span class="variable">$match</span>) &#123;</span><br><span class="line">                    <span class="variable">$dates</span>[] = [</span><br><span class="line">                        <span class="string">&#x27;date&#x27;</span> =&gt; <span class="variable">$match</span>,</span><br><span class="line">                        <span class="string">&#x27;format&#x27;</span> =&gt; <span class="variable">$format</span></span><br><span class="line">                    ];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$dates</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 清理和格式化电话号码</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">formatPhoneNumber</span>(<span class="params"><span class="variable">$phone</span>, <span class="variable">$format</span> = <span class="string">&#x27;xxx-xxxx-xxxx&#x27;</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 清理非数字字符</span></span><br><span class="line">        <span class="variable">$cleanPhone</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\D/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$phone</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 验证长度</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$cleanPhone</span>) !== <span class="number">11</span> || !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^1[3-9]/&#x27;</span>, <span class="variable">$cleanPhone</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 格式化</span></span><br><span class="line">        <span class="keyword">switch</span> (<span class="variable">$format</span>) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;xxx-xxxx-xxxx&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/(\d&#123;3&#125;)(\d&#123;4&#125;)(\d&#123;4&#125;)/&#x27;</span>, <span class="string">&#x27;$1-$2-$3&#x27;</span>, <span class="variable">$cleanPhone</span>);</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;xxx xxxx xxxx&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/(\d&#123;3&#125;)(\d&#123;4&#125;)(\d&#123;4&#125;)/&#x27;</span>, <span class="string">&#x27;$1 $2 $3&#x27;</span>, <span class="variable">$cleanPhone</span>);</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;(xxx) xxxx-xxxx&#x27;</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/(\d&#123;3&#125;)(\d&#123;4&#125;)(\d&#123;4&#125;)/&#x27;</span>, <span class="string">&#x27;($1) $2-$3&#x27;</span>, <span class="variable">$cleanPhone</span>);</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$cleanPhone</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用高级正则功能</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;=== 高级正则功能示例 ===\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// URL解析</span></span><br><span class="line"><span class="variable">$testUrl</span> = <span class="string">&quot;https://www.example.com/path/to/page?param=value#section&quot;</span>;</span><br><span class="line"><span class="variable">$urlParts</span> = <span class="title class_">AdvancedRegex</span>::<span class="title function_ invoke__">parseUrl</span>(<span class="variable">$testUrl</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$urlParts</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;URL解析结果:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$urlParts</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;- <span class="subst">$key</span>: <span class="subst">$value</span>\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 邮箱解析</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n邮箱解析:\n&quot;</span>;</span><br><span class="line"><span class="variable">$testEmail</span> = <span class="string">&quot;john.doe@example.com&quot;</span>;</span><br><span class="line"><span class="variable">$emailParts</span> = <span class="title class_">AdvancedRegex</span>::<span class="title function_ invoke__">parseEmail</span>(<span class="variable">$testEmail</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$emailParts</span>) &#123;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$emailParts</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;- <span class="subst">$key</span>: <span class="subst">$value</span>\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// HTML属性提取</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\nHTML属性提取:\n&quot;</span>;</span><br><span class="line"><span class="variable">$html</span> = <span class="string">&#x27;&lt;img   src=&quot;image.jpg&quot;  alt=&quot;测试图片&quot; width=&quot;300&quot; height=&quot;200&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="variable">$attributes</span> = <span class="title class_">AdvancedRegex</span>::<span class="title function_ invoke__">extractHtmlAttributes</span>(<span class="variable">$html</span>, <span class="string">&#x27;img&#x27;</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$attributes</span> <span class="keyword">as</span> <span class="variable">$attrs</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;图片属性: &quot;</span> . <span class="title function_ invoke__">json_encode</span>(<span class="variable">$attrs</span>, JSON_UNESCAPED_UNICODE) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 密码强度验证</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n密码强度验证:\n&quot;</span>;</span><br><span class="line"><span class="variable">$passwords</span> = [<span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;Password1&#x27;</span>, <span class="string">&#x27;StrongPass123!&#x27;</span>];</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$passwords</span> <span class="keyword">as</span> <span class="variable">$pwd</span>) &#123;</span><br><span class="line">    <span class="variable">$strength</span> = <span class="title class_">AdvancedRegex</span>::<span class="title function_ invoke__">validatePasswordStrength</span>(<span class="variable">$pwd</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;密码 &#x27;<span class="subst">$pwd</span>&#x27;: <span class="subst">&#123;$strength[&#x27;strength&#x27;]&#125;</span> (得分: <span class="subst">&#123;$strength[&#x27;score&#x27;]&#125;</span>/6)\n&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$strength</span>[<span class="string">&#x27;suggestions&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;  建议: &quot;</span> . <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;, &#x27;</span>, <span class="variable">$strength</span>[<span class="string">&#x27;suggestions&#x27;</span>]) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 日期提取</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n日期提取:\n&quot;</span>;</span><br><span class="line"><span class="variable">$dateText</span> = <span class="string">&quot;项目开始于2023-07-10，截止日期是2023年12月31日，会议安排在15/08/2023。&quot;</span>;</span><br><span class="line"><span class="variable">$dates</span> = <span class="title class_">AdvancedRegex</span>::<span class="title function_ invoke__">extractDates</span>(<span class="variable">$dateText</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$dates</span> <span class="keyword">as</span> <span class="variable">$date</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;找到日期: <span class="subst">&#123;$date[&#x27;date&#x27;]&#125;</span> (格式: <span class="subst">&#123;$date[&#x27;format&#x27;]&#125;</span>)\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 电话号码格式化</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n电话号码格式化:\n&quot;</span>;</span><br><span class="line"><span class="variable">$phones</span> = [<span class="string">&#x27;13812345678&#x27;</span>, <span class="string">&#x27;138-1234-5678&#x27;</span>, <span class="string">&#x27;(138) 1234-5678&#x27;</span>];</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$phones</span> <span class="keyword">as</span> <span class="variable">$phone</span>) &#123;</span><br><span class="line">    <span class="variable">$formatted</span> = <span class="title class_">AdvancedRegex</span>::<span class="title function_ invoke__">formatPhoneNumber</span>(<span class="variable">$phone</span>, <span class="string">&#x27;xxx-xxxx-xxxx&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;原号码: <span class="subst">$phone</span> -&gt; 格式化: &quot;</span> . (<span class="variable">$formatted</span> ?: <span class="string">&#x27;无效号码&#x27;</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-文本处理和内容提取"><a href="#3-文本处理和内容提取" class="headerlink" title="3. 文本处理和内容提取"></a>3. 文本处理和内容提取</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 文本处理和内容提取</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;=== 文本处理和内容提取 ===\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TextProcessor</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 提取文章摘要</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">extractSummary</span>(<span class="params"><span class="variable">$content</span>, <span class="variable">$maxLength</span> = <span class="number">200</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 移除HTML标签</span></span><br><span class="line">        <span class="variable">$text</span> = <span class="title function_ invoke__">strip_tags</span>(<span class="variable">$content</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 移除多余空白</span></span><br><span class="line">        <span class="variable">$text</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\s+/&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="title function_ invoke__">trim</span>(<span class="variable">$text</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 截取指定长度</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">mb_strlen</span>(<span class="variable">$text</span>) &lt;= <span class="variable">$maxLength</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$text</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 在单词边界截取</span></span><br><span class="line">        <span class="variable">$summary</span> = <span class="title function_ invoke__">mb_substr</span>(<span class="variable">$text</span>, <span class="number">0</span>, <span class="variable">$maxLength</span>);</span><br><span class="line">        <span class="variable">$lastSpace</span> = <span class="title function_ invoke__">mb_strrpos</span>(<span class="variable">$summary</span>, <span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$lastSpace</span> !== <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="variable">$summary</span> = <span class="title function_ invoke__">mb_substr</span>(<span class="variable">$summary</span>, <span class="number">0</span>, <span class="variable">$lastSpace</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$summary</span> . <span class="string">&#x27;...&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 提取关键词</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">extractKeywords</span>(<span class="params"><span class="variable">$text</span>, <span class="variable">$minLength</span> = <span class="number">3</span>, <span class="variable">$maxCount</span> = <span class="number">10</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 转换为小写并移除标点</span></span><br><span class="line">        <span class="variable">$text</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$text</span>);</span><br><span class="line">        <span class="variable">$text</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\w\s\x&#123;4e00&#125;-\x&#123;9fa5&#125;]/u&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="variable">$text</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 分割单词</span></span><br><span class="line">        <span class="variable">$words</span> = <span class="title function_ invoke__">preg_split</span>(<span class="string">&#x27;/\s+/&#x27;</span>, <span class="variable">$text</span>, -<span class="number">1</span>, PREG_SPLIT_NO_EMPTY);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 过滤停用词和短词</span></span><br><span class="line">        <span class="variable">$stopWords</span> = [<span class="string">&#x27;的&#x27;</span>, <span class="string">&#x27;是&#x27;</span>, <span class="string">&#x27;在&#x27;</span>, <span class="string">&#x27;有&#x27;</span>, <span class="string">&#x27;和&#x27;</span>, <span class="string">&#x27;与&#x27;</span>, <span class="string">&#x27;或&#x27;</span>, <span class="string">&#x27;但&#x27;</span>, <span class="string">&#x27;而&#x27;</span>, <span class="string">&#x27;了&#x27;</span>, <span class="string">&#x27;着&#x27;</span>, <span class="string">&#x27;过&#x27;</span>, <span class="string">&#x27;the&#x27;</span>, <span class="string">&#x27;is&#x27;</span>, <span class="string">&#x27;at&#x27;</span>, <span class="string">&#x27;which&#x27;</span>, <span class="string">&#x27;on&#x27;</span>, <span class="string">&#x27;and&#x27;</span>, <span class="string">&#x27;or&#x27;</span>, <span class="string">&#x27;but&#x27;</span>];</span><br><span class="line">        <span class="variable">$filteredWords</span> = <span class="title function_ invoke__">array_filter</span>(<span class="variable">$words</span>, function(<span class="variable">$word</span>) <span class="keyword">use</span> ($<span class="title">minLength</span>, $<span class="title">stopWords</span>) &#123;</span><br><span class="line">            <span class="title">return</span> <span class="title">mb_strlen</span>($<span class="title">word</span>) &gt;= $<span class="title">minLength</span> &amp;&amp; !<span class="title">in_array</span>($<span class="title">word</span>, $<span class="title">stopWords</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 统计词频</span></span><br><span class="line">        <span class="variable">$wordCount</span> = <span class="title function_ invoke__">array_count_values</span>(<span class="variable">$filteredWords</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 按频率排序</span></span><br><span class="line">        <span class="title function_ invoke__">arsort</span>(<span class="variable">$wordCount</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 返回前N个关键词</span></span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">array_slice</span>(<span class="title function_ invoke__">array_keys</span>(<span class="variable">$wordCount</span>), <span class="number">0</span>, <span class="variable">$maxCount</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 检测语言</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">detectLanguage</span>(<span class="params"><span class="variable">$text</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$patterns</span> = [</span><br><span class="line">            <span class="string">&#x27;chinese&#x27;</span> =&gt; <span class="string">&#x27;/[\x&#123;4e00&#125;-\x&#123;9fa5&#125;]/u&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;english&#x27;</span> =&gt; <span class="string">&#x27;/[a-zA-Z]/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;japanese&#x27;</span> =&gt; <span class="string">&#x27;/[\x&#123;3040&#125;-\x&#123;309f&#125;\x&#123;30a0&#125;-\x&#123;30ff&#125;]/u&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;korean&#x27;</span> =&gt; <span class="string">&#x27;/[\x&#123;ac00&#125;-\x&#123;d7af&#125;]/u&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;arabic&#x27;</span> =&gt; <span class="string">&#x27;/[\x&#123;0600&#125;-\x&#123;06ff&#125;]/u&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;russian&#x27;</span> =&gt; <span class="string">&#x27;/[\x&#123;0400&#125;-\x&#123;04ff&#125;]/u&#x27;</span></span><br><span class="line">        ];</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$scores</span> = [];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$patterns</span> <span class="keyword">as</span> <span class="variable">$lang</span> =&gt; <span class="variable">$pattern</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$pattern</span>, <span class="variable">$text</span>, <span class="variable">$matches</span>);</span><br><span class="line">            <span class="variable">$scores</span>[<span class="variable">$lang</span>] = <span class="title function_ invoke__">count</span>(<span class="variable">$matches</span>[<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 返回得分最高的语言</span></span><br><span class="line">        <span class="title function_ invoke__">arsort</span>(<span class="variable">$scores</span>);</span><br><span class="line">        <span class="variable">$topLang</span> = <span class="title function_ invoke__">key</span>(<span class="variable">$scores</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="string">&#x27;language&#x27;</span> =&gt; <span class="variable">$topLang</span>,</span><br><span class="line">            <span class="string">&#x27;confidence&#x27;</span> =&gt; <span class="variable">$scores</span>[<span class="variable">$topLang</span>] / <span class="title function_ invoke__">mb_strlen</span>(<span class="variable">$text</span>),</span><br><span class="line">            <span class="string">&#x27;scores&#x27;</span> =&gt; <span class="variable">$scores</span></span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 提取邮箱和电话</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">extractContacts</span>(<span class="params"><span class="variable">$text</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$contacts</span> = [</span><br><span class="line">            <span class="string">&#x27;emails&#x27;</span> =&gt; [],</span><br><span class="line">            <span class="string">&#x27;phones&#x27;</span> =&gt; [],</span><br><span class="line">            <span class="string">&#x27;urls&#x27;</span> =&gt; []</span><br><span class="line">        ];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 提取邮箱</span></span><br><span class="line">        <span class="variable">$emailPattern</span> = <span class="string">&#x27;/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]&#123;2,&#125;/&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$emailPattern</span>, <span class="variable">$text</span>, <span class="variable">$matches</span>)) &#123;</span><br><span class="line">            <span class="variable">$contacts</span>[<span class="string">&#x27;emails&#x27;</span>] = <span class="title function_ invoke__">array_unique</span>(<span class="variable">$matches</span>[<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 提取电话</span></span><br><span class="line">        <span class="variable">$phonePatterns</span> = [</span><br><span class="line">            <span class="string">&#x27;/1[3-9]\d&#123;9&#125;/&#x27;</span>,  <span class="comment">// 中国手机号</span></span><br><span class="line">            <span class="string">&#x27;/\d&#123;3&#125;-\d&#123;4&#125;-\d&#123;4&#125;/&#x27;</span>,  <span class="comment">// 格式化手机号</span></span><br><span class="line">            <span class="string">&#x27;/\(\d&#123;3&#125;\)\s*\d&#123;4&#125;-\d&#123;4&#125;/&#x27;</span>,  <span class="comment">// 美式电话</span></span><br><span class="line">            <span class="string">&#x27;/\d&#123;4&#125;-\d&#123;7&#125;/&#x27;</span>  <span class="comment">// 固定电话</span></span><br><span class="line">        ];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$phonePatterns</span> <span class="keyword">as</span> <span class="variable">$pattern</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$pattern</span>, <span class="variable">$text</span>, <span class="variable">$matches</span>)) &#123;</span><br><span class="line">                <span class="variable">$contacts</span>[<span class="string">&#x27;phones&#x27;</span>] = <span class="title function_ invoke__">array_merge</span>(<span class="variable">$contacts</span>[<span class="string">&#x27;phones&#x27;</span>], <span class="variable">$matches</span>[<span class="number">0</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$contacts</span>[<span class="string">&#x27;phones&#x27;</span>] = <span class="title function_ invoke__">array_unique</span>(<span class="variable">$contacts</span>[<span class="string">&#x27;phones&#x27;</span>]);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 提取URL</span></span><br><span class="line">        <span class="variable">$urlPattern</span> = <span class="string">&#x27;/https?:\/\/[^\s\/$.?#].[^\s]*/&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match_all</span>(<span class="variable">$urlPattern</span>, <span class="variable">$text</span>, <span class="variable">$matches</span>)) &#123;</span><br><span class="line">            <span class="variable">$contacts</span>[<span class="string">&#x27;urls&#x27;</span>] = <span class="title function_ invoke__">array_unique</span>(<span class="variable">$matches</span>[<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$contacts</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 格式化文本</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">formatText</span>(<span class="params"><span class="variable">$text</span>, <span class="variable">$options</span> = []</span>) </span>&#123;</span><br><span class="line">        <span class="variable">$defaults</span> = [</span><br><span class="line">            <span class="string">&#x27;remove_extra_spaces&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">            <span class="string">&#x27;fix_punctuation&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">            <span class="string">&#x27;capitalize_sentences&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">            <span class="string">&#x27;remove_empty_lines&#x27;</span> =&gt; <span class="literal">true</span></span><br><span class="line">        ];</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$options</span> = <span class="title function_ invoke__">array_merge</span>(<span class="variable">$defaults</span>, <span class="variable">$options</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 移除多余空格</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$options</span>[<span class="string">&#x27;remove_extra_spaces&#x27;</span>]) &#123;</span><br><span class="line">            <span class="variable">$text</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\s+/&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="variable">$text</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 修复标点符号</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$options</span>[<span class="string">&#x27;fix_punctuation&#x27;</span>]) &#123;</span><br><span class="line">            <span class="variable">$text</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\s+([,.!?;:])/&#x27;</span>, <span class="string">&#x27;$1&#x27;</span>, <span class="variable">$text</span>);</span><br><span class="line">            <span class="variable">$text</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/([,.!?;:])\s*/&#x27;</span>, <span class="string">&#x27;$1 &#x27;</span>, <span class="variable">$text</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 句首大写</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$options</span>[<span class="string">&#x27;capitalize_sentences&#x27;</span>]) &#123;</span><br><span class="line">            <span class="variable">$text</span> = <span class="title function_ invoke__">preg_replace_callback</span>(<span class="string">&#x27;/([.!?]\s+)([a-z])/&#x27;</span>, function(<span class="variable">$matches</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$matches</span>[<span class="number">1</span>] . <span class="title function_ invoke__">strtoupper</span>(<span class="variable">$matches</span>[<span class="number">2</span>]);</span><br><span class="line">            &#125;, <span class="variable">$text</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 首字母大写</span></span><br><span class="line">            <span class="variable">$text</span> = <span class="title function_ invoke__">ucfirst</span>(<span class="title function_ invoke__">trim</span>(<span class="variable">$text</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 移除空行</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$options</span>[<span class="string">&#x27;remove_empty_lines&#x27;</span>]) &#123;</span><br><span class="line">            <span class="variable">$text</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\n\s*\n/&#x27;</span>, <span class="string">&quot;\n&quot;</span>, <span class="variable">$text</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">trim</span>(<span class="variable">$text</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 生成文本统计</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getTextStats</span>(<span class="params"><span class="variable">$text</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$stats</span> = [</span><br><span class="line">            <span class="string">&#x27;characters&#x27;</span> =&gt; <span class="title function_ invoke__">mb_strlen</span>(<span class="variable">$text</span>),</span><br><span class="line">            <span class="string">&#x27;characters_no_spaces&#x27;</span> =&gt; <span class="title function_ invoke__">mb_strlen</span>(<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\s/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$text</span>)),</span><br><span class="line">            <span class="string">&#x27;words&#x27;</span> =&gt; <span class="title function_ invoke__">str_word_count</span>(<span class="title function_ invoke__">strip_tags</span>(<span class="variable">$text</span>)),</span><br><span class="line">            <span class="string">&#x27;sentences&#x27;</span> =&gt; <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&#x27;/[.!?]+/&#x27;</span>, <span class="variable">$text</span>),</span><br><span class="line">            <span class="string">&#x27;paragraphs&#x27;</span> =&gt; <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&#x27;/\n\s*\n/&#x27;</span>, <span class="variable">$text</span>) + <span class="number">1</span>,</span><br><span class="line">            <span class="string">&#x27;lines&#x27;</span> =&gt; <span class="title function_ invoke__">substr_count</span>(<span class="variable">$text</span>, <span class="string">&quot;\n&quot;</span>) + <span class="number">1</span></span><br><span class="line">        ];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 计算阅读时间（假设每分钟200字）</span></span><br><span class="line">        <span class="variable">$stats</span>[<span class="string">&#x27;reading_time&#x27;</span>] = <span class="title function_ invoke__">ceil</span>(<span class="variable">$stats</span>[<span class="string">&#x27;words&#x27;</span>] / <span class="number">200</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 计算平均句长</span></span><br><span class="line">        <span class="variable">$stats</span>[<span class="string">&#x27;avg_sentence_length&#x27;</span>] = <span class="variable">$stats</span>[<span class="string">&#x27;sentences&#x27;</span>] &gt; <span class="number">0</span> ? </span><br><span class="line">            <span class="title function_ invoke__">round</span>(<span class="variable">$stats</span>[<span class="string">&#x27;words&#x27;</span>] / <span class="variable">$stats</span>[<span class="string">&#x27;sentences&#x27;</span>], <span class="number">1</span>) : <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$stats</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用文本处理器</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;=== 文本处理器示例 ===\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$sampleText</span> = <span class="string">&quot;这是一篇关于PHP正则表达式的文章。正则表达式是处理文本的强大工具，在数据验证、文本解析和内容提取中发挥着重要作用。联系我们：邮箱support@example.com，电话13812345678，网站https://www.example.com。&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 提取摘要</span></span><br><span class="line"><span class="variable">$summary</span> = <span class="title class_">TextProcessor</span>::<span class="title function_ invoke__">extractSummary</span>(<span class="variable">$sampleText</span>, <span class="number">50</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;文章摘要: <span class="subst">$summary</span>\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 提取关键词</span></span><br><span class="line"><span class="variable">$keywords</span> = <span class="title class_">TextProcessor</span>::<span class="title function_ invoke__">extractKeywords</span>(<span class="variable">$sampleText</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;关键词: &quot;</span> . <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;, &#x27;</span>, <span class="variable">$keywords</span>) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 语言检测</span></span><br><span class="line"><span class="variable">$langInfo</span> = <span class="title class_">TextProcessor</span>::<span class="title function_ invoke__">detectLanguage</span>(<span class="variable">$sampleText</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;检测语言: <span class="subst">&#123;$langInfo[&#x27;language&#x27;]&#125;</span> (置信度: &quot;</span> . <span class="title function_ invoke__">round</span>(<span class="variable">$langInfo</span>[<span class="string">&#x27;confidence&#x27;</span>], <span class="number">2</span>) . <span class="string">&quot;)\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 提取联系信息</span></span><br><span class="line"><span class="variable">$contacts</span> = <span class="title class_">TextProcessor</span>::<span class="title function_ invoke__">extractContacts</span>(<span class="variable">$sampleText</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;联系信息:\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;- 邮箱: &quot;</span> . <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;, &#x27;</span>, <span class="variable">$contacts</span>[<span class="string">&#x27;emails&#x27;</span>]) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;- 电话: &quot;</span> . <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;, &#x27;</span>, <span class="variable">$contacts</span>[<span class="string">&#x27;phones&#x27;</span>]) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;- 网址: &quot;</span> . <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;, &#x27;</span>, <span class="variable">$contacts</span>[<span class="string">&#x27;urls&#x27;</span>]) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 文本统计</span></span><br><span class="line"><span class="variable">$stats</span> = <span class="title class_">TextProcessor</span>::<span class="title function_ invoke__">getTextStats</span>(<span class="variable">$sampleText</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n文本统计:\n&quot;</span>;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$stats</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">    <span class="variable">$label</span> = [</span><br><span class="line">        <span class="string">&#x27;characters&#x27;</span> =&gt; <span class="string">&#x27;字符数&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;characters_no_spaces&#x27;</span> =&gt; <span class="string">&#x27;字符数(不含空格)&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;words&#x27;</span> =&gt; <span class="string">&#x27;单词数&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sentences&#x27;</span> =&gt; <span class="string">&#x27;句子数&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;paragraphs&#x27;</span> =&gt; <span class="string">&#x27;段落数&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;lines&#x27;</span> =&gt; <span class="string">&#x27;行数&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;reading_time&#x27;</span> =&gt; <span class="string">&#x27;阅读时间(分钟)&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;avg_sentence_length&#x27;</span> =&gt; <span class="string">&#x27;平均句长&#x27;</span></span><br><span class="line">    ][<span class="variable">$key</span>] ?? <span class="variable">$key</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;- <span class="subst">$label</span>: <span class="subst">$value</span>\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 格式化文本</span></span><br><span class="line"><span class="variable">$messyText</span> = <span class="string">&quot;这是一段   格式混乱的文本  。有多余的空格   ，标点符号也不规范,还有   。&quot;</span>;</span><br><span class="line"><span class="variable">$formattedText</span> = <span class="title class_">TextProcessor</span>::<span class="title function_ invoke__">formatText</span>(<span class="variable">$messyText</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n格式化前: <span class="subst">$messyText</span>\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;格式化后: <span class="subst">$formattedText</span>\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="实际应用场景"><a href="#实际应用场景" class="headerlink" title="实际应用场景"></a>实际应用场景</h2><h3 id="1-数据验证和清理"><a href="#1-数据验证和清理" class="headerlink" title="1. 数据验证和清理"></a>1. 数据验证和清理</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 数据验证和清理应用</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;=== 数据验证和清理应用 ===\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DataValidator</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 验证用户注册数据</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">validateRegistration</span>(<span class="params"><span class="variable">$data</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$errors</span> = [];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 验证用户名</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$data</span>[<span class="string">&#x27;username&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$errors</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="string">&#x27;用户名不能为空&#x27;</span>;</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-zA-Z0-9_]&#123;3,20&#125;$/&#x27;</span>, <span class="variable">$data</span>[<span class="string">&#x27;username&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$errors</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="string">&#x27;用户名只能包含字母、数字和下划线，长度3-20位&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 验证邮箱</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$data</span>[<span class="string">&#x27;email&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$errors</span>[<span class="string">&#x27;email&#x27;</span>] = <span class="string">&#x27;邮箱不能为空&#x27;</span>;</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]&#123;2,&#125;$/&#x27;</span>, <span class="variable">$data</span>[<span class="string">&#x27;email&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$errors</span>[<span class="string">&#x27;email&#x27;</span>] = <span class="string">&#x27;邮箱格式不正确&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 验证密码</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$data</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$errors</span>[<span class="string">&#x27;password&#x27;</span>] = <span class="string">&#x27;密码不能为空&#x27;</span>;</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&amp;])[A-Za-z\d@$!%*?&amp;]&#123;8,&#125;$/&#x27;</span>, <span class="variable">$data</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$errors</span>[<span class="string">&#x27;password&#x27;</span>] = <span class="string">&#x27;密码必须包含大小写字母、数字和特殊字符，至少8位&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 验证手机号</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$data</span>[<span class="string">&#x27;phone&#x27;</span>]) &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^1[3-9]\d&#123;9&#125;$/&#x27;</span>, <span class="variable">$data</span>[<span class="string">&#x27;phone&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$errors</span>[<span class="string">&#x27;phone&#x27;</span>] = <span class="string">&#x27;手机号格式不正确&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 验证身份证号</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$data</span>[<span class="string">&#x27;idcard&#x27;</span>]) &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^\d&#123;17&#125;[\dX]$/&#x27;</span>, <span class="variable">$data</span>[<span class="string">&#x27;idcard&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$errors</span>[<span class="string">&#x27;idcard&#x27;</span>] = <span class="string">&#x27;身份证号格式不正确&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$errors</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 清理用户输入</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">sanitizeInput</span>(<span class="params"><span class="variable">$data</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$sanitized</span> = [];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$data</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$value</span>)) &#123;</span><br><span class="line">                <span class="comment">// 移除HTML标签</span></span><br><span class="line">                <span class="variable">$value</span> = <span class="title function_ invoke__">strip_tags</span>(<span class="variable">$value</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 移除多余空白</span></span><br><span class="line">                <span class="variable">$value</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\s+/&#x27;</span>, <span class="string">&#x27; &#x27;</span>, <span class="title function_ invoke__">trim</span>(<span class="variable">$value</span>));</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 转义特殊字符</span></span><br><span class="line">                <span class="variable">$value</span> = <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$value</span>, ENT_QUOTES, <span class="string">&#x27;UTF-8&#x27;</span>);</span><br><span class="line">                </span><br><span class="line">                <span class="variable">$sanitized</span>[<span class="variable">$key</span>] = <span class="variable">$value</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$sanitized</span>[<span class="variable">$key</span>] = <span class="variable">$value</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$sanitized</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 验证和格式化银行卡号</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">validateBankCard</span>(<span class="params"><span class="variable">$cardNumber</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 移除空格和连字符</span></span><br><span class="line">        <span class="variable">$cleanNumber</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\s-]/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$cardNumber</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 检查是否只包含数字</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^\d+$/&#x27;</span>, <span class="variable">$cleanNumber</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> [<span class="string">&#x27;valid&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;银行卡号只能包含数字&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 检查长度</span></span><br><span class="line">        <span class="variable">$length</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$cleanNumber</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$length</span> &lt; <span class="number">13</span> || <span class="variable">$length</span> &gt; <span class="number">19</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> [<span class="string">&#x27;valid&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;银行卡号长度不正确&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Luhn算法验证</span></span><br><span class="line">        <span class="variable">$sum</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$alternate</span> = <span class="literal">false</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="variable">$length</span> - <span class="number">1</span>; <span class="variable">$i</span> &gt;= <span class="number">0</span>; <span class="variable">$i</span>--) &#123;</span><br><span class="line">            <span class="variable">$digit</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$cleanNumber</span>[<span class="variable">$i</span>]);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$alternate</span>) &#123;</span><br><span class="line">                <span class="variable">$digit</span> *= <span class="number">2</span>;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$digit</span> &gt; <span class="number">9</span>) &#123;</span><br><span class="line">                    <span class="variable">$digit</span> = (<span class="variable">$digit</span> % <span class="number">10</span>) + <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="variable">$sum</span> += <span class="variable">$digit</span>;</span><br><span class="line">            <span class="variable">$alternate</span> = !<span class="variable">$alternate</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$isValid</span> = (<span class="variable">$sum</span> % <span class="number">10</span> === <span class="number">0</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$isValid</span>) &#123;</span><br><span class="line">            <span class="comment">// 格式化显示</span></span><br><span class="line">            <span class="variable">$formatted</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/(\d&#123;4&#125;)/&#x27;</span>, <span class="string">&#x27;$1 &#x27;</span>, <span class="variable">$cleanNumber</span>);</span><br><span class="line">            <span class="variable">$formatted</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$formatted</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> [</span><br><span class="line">                <span class="string">&#x27;valid&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">                <span class="string">&#x27;original&#x27;</span> =&gt; <span class="variable">$cardNumber</span>,</span><br><span class="line">                <span class="string">&#x27;clean&#x27;</span> =&gt; <span class="variable">$cleanNumber</span>,</span><br><span class="line">                <span class="string">&#x27;formatted&#x27;</span> =&gt; <span class="variable">$formatted</span>,</span><br><span class="line">                <span class="string">&#x27;type&#x27;</span> =&gt; <span class="built_in">self</span>::<span class="title function_ invoke__">getBankCardType</span>(<span class="variable">$cleanNumber</span>)</span><br><span class="line">            ];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> [<span class="string">&#x27;valid&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;银行卡号校验失败&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 识别银行卡类型</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getBankCardType</span>(<span class="params"><span class="variable">$cardNumber</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$patterns</span> = [</span><br><span class="line">            <span class="string">&#x27;visa&#x27;</span> =&gt; <span class="string">&#x27;/^4\d&#123;12&#125;(\d&#123;3&#125;)?$/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;mastercard&#x27;</span> =&gt; <span class="string">&#x27;/^5[1-5]\d&#123;14&#125;$/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;amex&#x27;</span> =&gt; <span class="string">&#x27;/^3[47]\d&#123;13&#125;$/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;discover&#x27;</span> =&gt; <span class="string">&#x27;/^6011\d&#123;12&#125;$/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;unionpay&#x27;</span> =&gt; <span class="string">&#x27;/^62\d&#123;14,17&#125;$/&#x27;</span></span><br><span class="line">        ];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$patterns</span> <span class="keyword">as</span> <span class="variable">$type</span> =&gt; <span class="variable">$pattern</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>, <span class="variable">$cardNumber</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$type</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;unknown&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用数据验证器</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;=== 数据验证器示例 ===\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试注册数据验证</span></span><br><span class="line"><span class="variable">$registrationData</span> = [</span><br><span class="line">    <span class="string">&#x27;username&#x27;</span> =&gt; <span class="string">&#x27;john_doe&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;email&#x27;</span> =&gt; <span class="string">&#x27;john@example.com&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;StrongPass123!&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;phone&#x27;</span> =&gt; <span class="string">&#x27;13812345678&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;idcard&#x27;</span> =&gt; <span class="string">&#x27;12345678901234567X&#x27;</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="variable">$errors</span> = <span class="title class_">DataValidator</span>::<span class="title function_ invoke__">validateRegistration</span>(<span class="variable">$registrationData</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$errors</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;注册数据验证通过\n&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 清理数据</span></span><br><span class="line">    <span class="variable">$cleanData</span> = <span class="title class_">DataValidator</span>::<span class="title function_ invoke__">sanitizeInput</span>(<span class="variable">$registrationData</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;清理后的数据: &quot;</span> . <span class="title function_ invoke__">json_encode</span>(<span class="variable">$cleanData</span>, JSON_UNESCAPED_UNICODE) . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;注册数据验证失败:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$errors</span> <span class="keyword">as</span> <span class="variable">$field</span> =&gt; <span class="variable">$error</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;- <span class="subst">$field</span>: <span class="subst">$error</span>\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试银行卡验证</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n银行卡验证:\n&quot;</span>;</span><br><span class="line"><span class="variable">$testCards</span> = [</span><br><span class="line">    <span class="string">&#x27;4111 1111 1111 1111&#x27;</span>,  <span class="comment">// Visa测试卡号</span></span><br><span class="line">    <span class="string">&#x27;5555555555554444&#x27;</span>,     <span class="comment">// MasterCard测试卡号</span></span><br><span class="line">    <span class="string">&#x27;1234567890123456&#x27;</span>      <span class="comment">// 无效卡号</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$testCards</span> <span class="keyword">as</span> <span class="variable">$card</span>) &#123;</span><br><span class="line">    <span class="variable">$result</span> = <span class="title class_">DataValidator</span>::<span class="title function_ invoke__">validateBankCard</span>(<span class="variable">$card</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;卡号 <span class="subst">$card</span>: &quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$result</span>[<span class="string">&#x27;valid&#x27;</span>]) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;有效 (<span class="subst">&#123;$result[&#x27;type&#x27;]&#125;</span>) - 格式化: <span class="subst">&#123;$result[&#x27;formatted&#x27;]&#125;</span>\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;无效 - <span class="subst">&#123;$result[&#x27;message&#x27;]&#125;</span>\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-日志分析和监控"><a href="#2-日志分析和监控" class="headerlink" title="2. 日志分析和监控"></a>2. 日志分析和监控</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 日志分析和监控</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;=== 日志分析和监控 ===\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LogAnalyzer</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 解析Apache访问日志</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">parseAccessLog</span>(<span class="params"><span class="variable">$logLine</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// Apache Common Log Format</span></span><br><span class="line">        <span class="variable">$pattern</span> = <span class="string">&#x27;/^(\S+) \S+ \S+ \[([^\]]+)\] &quot;([^&quot;]*)&quot; (\d+) (\S+)(?: &quot;([^&quot;]*)&quot; &quot;([^&quot;]*)&quot;)?/&#x27;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>, <span class="variable">$logLine</span>, <span class="variable">$matches</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> [</span><br><span class="line">                <span class="string">&#x27;ip&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">1</span>],</span><br><span class="line">                <span class="string">&#x27;timestamp&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">2</span>],</span><br><span class="line">                <span class="string">&#x27;request&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">3</span>],</span><br><span class="line">                <span class="string">&#x27;status&#x27;</span> =&gt; <span class="title function_ invoke__">intval</span>(<span class="variable">$matches</span>[<span class="number">4</span>]),</span><br><span class="line">                <span class="string">&#x27;size&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">5</span>] === <span class="string">&#x27;-&#x27;</span> ? <span class="number">0</span> : <span class="title function_ invoke__">intval</span>(<span class="variable">$matches</span>[<span class="number">5</span>]),</span><br><span class="line">                <span class="string">&#x27;referer&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">6</span>] ?? <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;user_agent&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">7</span>] ?? <span class="string">&#x27;&#x27;</span></span><br><span class="line">            ];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 解析PHP错误日志</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">parseErrorLog</span>(<span class="params"><span class="variable">$logLine</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$pattern</span> = <span class="string">&#x27;/^\[([^\]]+)\] PHP (Fatal error|Warning|Notice|Parse error): (.+) in (.+) on line (\d+)/&#x27;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>, <span class="variable">$logLine</span>, <span class="variable">$matches</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> [</span><br><span class="line">                <span class="string">&#x27;timestamp&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">1</span>],</span><br><span class="line">                <span class="string">&#x27;level&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">2</span>],</span><br><span class="line">                <span class="string">&#x27;message&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">3</span>],</span><br><span class="line">                <span class="string">&#x27;file&#x27;</span> =&gt; <span class="variable">$matches</span>[<span class="number">4</span>],</span><br><span class="line">                <span class="string">&#x27;line&#x27;</span> =&gt; <span class="title function_ invoke__">intval</span>(<span class="variable">$matches</span>[<span class="number">5</span>])</span><br><span class="line">            ];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 检测可疑活动</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">detectSuspiciousActivity</span>(<span class="params"><span class="variable">$logEntries</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$suspicious</span> = [];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$logEntries</span> <span class="keyword">as</span> <span class="variable">$entry</span>) &#123;</span><br><span class="line">            <span class="variable">$flags</span> = [];</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 检测SQL注入尝试</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/union\s+select|drop\s+table|insert\s+into|delete\s+from/i&#x27;</span>, <span class="variable">$entry</span>[<span class="string">&#x27;request&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>)) &#123;</span><br><span class="line">                <span class="variable">$flags</span>[] = <span class="string">&#x27;SQL注入尝试&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 检测XSS尝试</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&lt;script|javascript:|onload=|onerror=/i&#x27;</span>, <span class="variable">$entry</span>[<span class="string">&#x27;request&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>)) &#123;</span><br><span class="line">                <span class="variable">$flags</span>[] = <span class="string">&#x27;XSS攻击尝试&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 检测路径遍历</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\.\.\/|\.\.\\\\/&#x27;</span>, <span class="variable">$entry</span>[<span class="string">&#x27;request&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>)) &#123;</span><br><span class="line">                <span class="variable">$flags</span>[] = <span class="string">&#x27;路径遍历尝试&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 检测暴力破解</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$entry</span>[<span class="string">&#x27;status&#x27;</span>]) &amp;&amp; <span class="variable">$entry</span>[<span class="string">&#x27;status&#x27;</span>] === <span class="number">401</span>) &#123;</span><br><span class="line">                <span class="variable">$flags</span>[] = <span class="string">&#x27;认证失败&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 检测异常状态码</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$entry</span>[<span class="string">&#x27;status&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">in_array</span>(<span class="variable">$entry</span>[<span class="string">&#x27;status&#x27;</span>], [<span class="number">500</span>, <span class="number">502</span>, <span class="number">503</span>, <span class="number">504</span>])) &#123;</span><br><span class="line">                <span class="variable">$flags</span>[] = <span class="string">&#x27;服务器错误&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$flags</span>)) &#123;</span><br><span class="line">                <span class="variable">$entry</span>[<span class="string">&#x27;flags&#x27;</span>] = <span class="variable">$flags</span>;</span><br><span class="line">                <span class="variable">$suspicious</span>[] = <span class="variable">$entry</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$suspicious</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 统计访问情况</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">analyzeTraffic</span>(<span class="params"><span class="variable">$logEntries</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$stats</span> = [</span><br><span class="line">            <span class="string">&#x27;total_requests&#x27;</span> =&gt; <span class="title function_ invoke__">count</span>(<span class="variable">$logEntries</span>),</span><br><span class="line">            <span class="string">&#x27;unique_ips&#x27;</span> =&gt; [],</span><br><span class="line">            <span class="string">&#x27;status_codes&#x27;</span> =&gt; [],</span><br><span class="line">            <span class="string">&#x27;top_pages&#x27;</span> =&gt; [],</span><br><span class="line">            <span class="string">&#x27;user_agents&#x27;</span> =&gt; [],</span><br><span class="line">            <span class="string">&#x27;hourly_traffic&#x27;</span> =&gt; []</span><br><span class="line">        ];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$logEntries</span> <span class="keyword">as</span> <span class="variable">$entry</span>) &#123;</span><br><span class="line">            <span class="comment">// 统计IP</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$entry</span>[<span class="string">&#x27;ip&#x27;</span>])) &#123;</span><br><span class="line">                <span class="variable">$stats</span>[<span class="string">&#x27;unique_ips&#x27;</span>][<span class="variable">$entry</span>[<span class="string">&#x27;ip&#x27;</span>]] = (<span class="variable">$stats</span>[<span class="string">&#x27;unique_ips&#x27;</span>][<span class="variable">$entry</span>[<span class="string">&#x27;ip&#x27;</span>]] ?? <span class="number">0</span>) + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 统计状态码</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$entry</span>[<span class="string">&#x27;status&#x27;</span>])) &#123;</span><br><span class="line">                <span class="variable">$stats</span>[<span class="string">&#x27;status_codes&#x27;</span>][<span class="variable">$entry</span>[<span class="string">&#x27;status&#x27;</span>]] = (<span class="variable">$stats</span>[<span class="string">&#x27;status_codes&#x27;</span>][<span class="variable">$entry</span>[<span class="string">&#x27;status&#x27;</span>]] ?? <span class="number">0</span>) + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 统计页面访问</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$entry</span>[<span class="string">&#x27;request&#x27;</span>])) &#123;</span><br><span class="line">                <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^\w+ ([^\s\?]+)/&#x27;</span>, <span class="variable">$entry</span>[<span class="string">&#x27;request&#x27;</span>], <span class="variable">$matches</span>);</span><br><span class="line">                <span class="variable">$page</span> = <span class="variable">$matches</span>[<span class="number">1</span>] ?? <span class="string">&#x27;unknown&#x27;</span>;</span><br><span class="line">                <span class="variable">$stats</span>[<span class="string">&#x27;top_pages&#x27;</span>][<span class="variable">$page</span>] = (<span class="variable">$stats</span>[<span class="string">&#x27;top_pages&#x27;</span>][<span class="variable">$page</span>] ?? <span class="number">0</span>) + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 统计User Agent</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$entry</span>[<span class="string">&#x27;user_agent&#x27;</span>])) &#123;</span><br><span class="line">                <span class="variable">$stats</span>[<span class="string">&#x27;user_agents&#x27;</span>][<span class="variable">$entry</span>[<span class="string">&#x27;user_agent&#x27;</span>]] = (<span class="variable">$stats</span>[<span class="string">&#x27;user_agents&#x27;</span>][<span class="variable">$entry</span>[<span class="string">&#x27;user_agent&#x27;</span>]] ?? <span class="number">0</span>) + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 统计小时流量</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$entry</span>[<span class="string">&#x27;timestamp&#x27;</span>])) &#123;</span><br><span class="line">                <span class="variable">$hour</span> = <span class="title function_ invoke__">date</span>(<span class="string">&#x27;H&#x27;</span>, <span class="title function_ invoke__">strtotime</span>(<span class="variable">$entry</span>[<span class="string">&#x27;timestamp&#x27;</span>]));</span><br><span class="line">                <span class="variable">$stats</span>[<span class="string">&#x27;hourly_traffic&#x27;</span>][<span class="variable">$hour</span>] = (<span class="variable">$stats</span>[<span class="string">&#x27;hourly_traffic&#x27;</span>][<span class="variable">$hour</span>] ?? <span class="number">0</span>) + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 排序统计结果</span></span><br><span class="line">        <span class="title function_ invoke__">arsort</span>(<span class="variable">$stats</span>[<span class="string">&#x27;unique_ips&#x27;</span>]);</span><br><span class="line">        <span class="title function_ invoke__">arsort</span>(<span class="variable">$stats</span>[<span class="string">&#x27;status_codes&#x27;</span>]);</span><br><span class="line">        <span class="title function_ invoke__">arsort</span>(<span class="variable">$stats</span>[<span class="string">&#x27;top_pages&#x27;</span>]);</span><br><span class="line">        <span class="title function_ invoke__">arsort</span>(<span class="variable">$stats</span>[<span class="string">&#x27;user_agents&#x27;</span>]);</span><br><span class="line">        <span class="title function_ invoke__">ksort</span>(<span class="variable">$stats</span>[<span class="string">&#x27;hourly_traffic&#x27;</span>]);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 只保留前10项</span></span><br><span class="line">        <span class="variable">$stats</span>[<span class="string">&#x27;unique_ips&#x27;</span>] = <span class="title function_ invoke__">array_slice</span>(<span class="variable">$stats</span>[<span class="string">&#x27;unique_ips&#x27;</span>], <span class="number">0</span>, <span class="number">10</span>, <span class="literal">true</span>);</span><br><span class="line">        <span class="variable">$stats</span>[<span class="string">&#x27;top_pages&#x27;</span>] = <span class="title function_ invoke__">array_slice</span>(<span class="variable">$stats</span>[<span class="string">&#x27;top_pages&#x27;</span>], <span class="number">0</span>, <span class="number">10</span>, <span class="literal">true</span>);</span><br><span class="line">        <span class="variable">$stats</span>[<span class="string">&#x27;user_agents&#x27;</span>] = <span class="title function_ invoke__">array_slice</span>(<span class="variable">$stats</span>[<span class="string">&#x27;user_agents&#x27;</span>], <span class="number">0</span>, <span class="number">5</span>, <span class="literal">true</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$stats</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 生成报告</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">generateReport</span>(<span class="params"><span class="variable">$logEntries</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$traffic</span> = <span class="built_in">self</span>::<span class="title function_ invoke__">analyzeTraffic</span>(<span class="variable">$logEntries</span>);</span><br><span class="line">        <span class="variable">$suspicious</span> = <span class="built_in">self</span>::<span class="title function_ invoke__">detectSuspiciousActivity</span>(<span class="variable">$logEntries</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$report</span> = [</span><br><span class="line">            <span class="string">&#x27;summary&#x27;</span> =&gt; [</span><br><span class="line">                <span class="string">&#x27;total_requests&#x27;</span> =&gt; <span class="variable">$traffic</span>[<span class="string">&#x27;total_requests&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;unique_visitors&#x27;</span> =&gt; <span class="title function_ invoke__">count</span>(<span class="variable">$traffic</span>[<span class="string">&#x27;unique_ips&#x27;</span>]),</span><br><span class="line">                <span class="string">&#x27;suspicious_activities&#x27;</span> =&gt; <span class="title function_ invoke__">count</span>(<span class="variable">$suspicious</span>),</span><br><span class="line">                <span class="string">&#x27;error_rate&#x27;</span> =&gt; <span class="keyword">isset</span>(<span class="variable">$traffic</span>[<span class="string">&#x27;status_codes&#x27;</span>][<span class="number">500</span>]) ? </span><br><span class="line">                    <span class="title function_ invoke__">round</span>((<span class="variable">$traffic</span>[<span class="string">&#x27;status_codes&#x27;</span>][<span class="number">500</span>] / <span class="variable">$traffic</span>[<span class="string">&#x27;total_requests&#x27;</span>]) * <span class="number">100</span>, <span class="number">2</span>) : <span class="number">0</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="string">&#x27;traffic_analysis&#x27;</span> =&gt; <span class="variable">$traffic</span>,</span><br><span class="line">            <span class="string">&#x27;security_alerts&#x27;</span> =&gt; <span class="variable">$suspicious</span></span><br><span class="line">        ];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$report</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用日志分析器</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;=== 日志分析器示例 ===\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模拟日志数据</span></span><br><span class="line"><span class="variable">$sampleLogs</span> = [</span><br><span class="line">    <span class="string">&#x27;192.168.1.100 - - [10/Jul/2023:16:45:30 +0800] &quot;GET /index.php HTTP/1.1&quot; 200 1234 &quot;https://www.google.com&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36&quot;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;192.168.1.101 - - [10/Jul/2023:16:46:15 +0800] &quot;POST /login.php HTTP/1.1&quot; 401 567 &quot;-&quot; &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36&quot;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;192.168.1.102 - - [10/Jul/2023:16:47:22 +0800] &quot;GET /admin.php?id=1 UNION SELECT * FROM users HTTP/1.1&quot; 403 0 &quot;-&quot; &quot;sqlmap/1.0&quot;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;192.168.1.100 - - [10/Jul/2023:16:48:10 +0800] &quot;GET /contact.php HTTP/1.1&quot; 200 2345 &quot;https://www.example.com&quot; &quot;Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X)&quot;&#x27;</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="variable">$parsedLogs</span> = [];</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$sampleLogs</span> <span class="keyword">as</span> <span class="variable">$log</span>) &#123;</span><br><span class="line">    <span class="variable">$parsed</span> = <span class="title class_">LogAnalyzer</span>::<span class="title function_ invoke__">parseAccessLog</span>(<span class="variable">$log</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$parsed</span>) &#123;</span><br><span class="line">        <span class="variable">$parsedLogs</span>[] = <span class="variable">$parsed</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;解析了 &quot;</span> . <span class="title function_ invoke__">count</span>(<span class="variable">$parsedLogs</span>) . <span class="string">&quot; 条日志记录\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成分析报告</span></span><br><span class="line"><span class="variable">$report</span> = <span class="title class_">LogAnalyzer</span>::<span class="title function_ invoke__">generateReport</span>(<span class="variable">$parsedLogs</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n=== 流量分析报告 ===\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;总请求数: <span class="subst">&#123;$report[&#x27;summary&#x27;][&#x27;total_requests&#x27;]&#125;</span>\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;独立访客: <span class="subst">&#123;$report[&#x27;summary&#x27;][&#x27;unique_visitors&#x27;]&#125;</span>\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;可疑活动: <span class="subst">&#123;$report[&#x27;summary&#x27;][&#x27;suspicious_activities&#x27;]&#125;</span>\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;错误率: <span class="subst">&#123;$report[&#x27;summary&#x27;][&#x27;error_rate&#x27;]&#125;</span>%\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n热门页面:\n&quot;</span>;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$report</span>[<span class="string">&#x27;traffic_analysis&#x27;</span>][<span class="string">&#x27;top_pages&#x27;</span>] <span class="keyword">as</span> <span class="variable">$page</span> =&gt; <span class="variable">$count</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;- <span class="subst">$page</span>: <span class="subst">$count</span> 次访问\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n状态码分布:\n&quot;</span>;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$report</span>[<span class="string">&#x27;traffic_analysis&#x27;</span>][<span class="string">&#x27;status_codes&#x27;</span>] <span class="keyword">as</span> <span class="variable">$code</span> =&gt; <span class="variable">$count</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;- <span class="subst">$code</span>: <span class="subst">$count</span> 次\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$report</span>[<span class="string">&#x27;security_alerts&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;\n=== 安全警报 ===\n&quot;</span>;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$report</span>[<span class="string">&#x27;security_alerts&#x27;</span>] <span class="keyword">as</span> <span class="variable">$alert</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;IP: <span class="subst">&#123;$alert[&#x27;ip&#x27;]&#125;</span>, 时间: <span class="subst">&#123;$alert[&#x27;timestamp&#x27;]&#125;</span>\n&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;请求: <span class="subst">&#123;$alert[&#x27;request&#x27;]&#125;</span>\n&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;威胁类型: &quot;</span> . <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;, &#x27;</span>, <span class="variable">$alert</span>[<span class="string">&#x27;flags&#x27;</span>]) . <span class="string">&quot;\n\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="性能优化和最佳实践"><a href="#性能优化和最佳实践" class="headerlink" title="性能优化和最佳实践"></a>性能优化和最佳实践</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 正则表达式性能优化</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;=== 性能优化和最佳实践 ===\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RegexOptimizer</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 编译和缓存正则表达式</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$compiledPatterns</span> = [];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">match</span>(<span class="params"><span class="variable">$pattern</span>, <span class="variable">$subject</span>, &amp;<span class="variable">$matches</span> = <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 缓存编译后的模式</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="built_in">self</span>::<span class="variable">$compiledPatterns</span>[<span class="variable">$pattern</span>])) &#123;</span><br><span class="line">            <span class="built_in">self</span>::<span class="variable">$compiledPatterns</span>[<span class="variable">$pattern</span>] = <span class="variable">$pattern</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">preg_match</span>(<span class="built_in">self</span>::<span class="variable">$compiledPatterns</span>[<span class="variable">$pattern</span>], <span class="variable">$subject</span>, <span class="variable">$matches</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 性能测试</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">benchmarkPatterns</span>(<span class="params"><span class="variable">$patterns</span>, <span class="variable">$testString</span>, <span class="variable">$iterations</span> = <span class="number">1000</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$results</span> = [];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$patterns</span> <span class="keyword">as</span> <span class="variable">$name</span> =&gt; <span class="variable">$pattern</span>) &#123;</span><br><span class="line">            <span class="variable">$startTime</span> = <span class="title function_ invoke__">microtime</span>(<span class="literal">true</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$iterations</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">                <span class="title function_ invoke__">preg_match</span>(<span class="variable">$pattern</span>, <span class="variable">$testString</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="variable">$endTime</span> = <span class="title function_ invoke__">microtime</span>(<span class="literal">true</span>);</span><br><span class="line">            <span class="variable">$results</span>[<span class="variable">$name</span>] = [</span><br><span class="line">                <span class="string">&#x27;pattern&#x27;</span> =&gt; <span class="variable">$pattern</span>,</span><br><span class="line">                <span class="string">&#x27;time&#x27;</span> =&gt; <span class="title function_ invoke__">round</span>((<span class="variable">$endTime</span> - <span class="variable">$startTime</span>) * <span class="number">1000</span>, <span class="number">4</span>),</span><br><span class="line">                <span class="string">&#x27;avg_time&#x27;</span> =&gt; <span class="title function_ invoke__">round</span>(((<span class="variable">$endTime</span> - <span class="variable">$startTime</span>) * <span class="number">1000</span>) / <span class="variable">$iterations</span>, <span class="number">6</span>)</span><br><span class="line">            ];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$results</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 优化建议</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">analyzePattern</span>(<span class="params"><span class="variable">$pattern</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$suggestions</span> = [];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 检查是否使用了锚点</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[\^]|[\$]$/&#x27;</span>, <span class="variable">$pattern</span>)) &#123;</span><br><span class="line">            <span class="variable">$suggestions</span>[] = <span class="string">&#x27;考虑使用锚点(^$)来提高匹配效率&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 检查是否有不必要的捕获组</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\([^?]/&#x27;</span>, <span class="variable">$pattern</span>)) &#123;</span><br><span class="line">            <span class="variable">$suggestions</span>[] = <span class="string">&#x27;考虑使用非捕获组(?:...)来提高性能&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 检查是否有过度的量词</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\.\*\.\*|\.\+\.\+/&#x27;</span>, <span class="variable">$pattern</span>)) &#123;</span><br><span class="line">            <span class="variable">$suggestions</span>[] = <span class="string">&#x27;避免连续使用贪婪量词，可能导致回溯问题&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 检查字符类优化</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\[a-zA-Z\]/&#x27;</span>, <span class="variable">$pattern</span>)) &#123;</span><br><span class="line">            <span class="variable">$suggestions</span>[] = <span class="string">&#x27;可以使用[[:alpha:]]替代[a-zA-Z]&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\[0-9\]/&#x27;</span>, <span class="variable">$pattern</span>)) &#123;</span><br><span class="line">            <span class="variable">$suggestions</span>[] = <span class="string">&#x27;可以使用\\d替代[0-9]&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="string">&#x27;pattern&#x27;</span> =&gt; <span class="variable">$pattern</span>,</span><br><span class="line">            <span class="string">&#x27;suggestions&#x27;</span> =&gt; <span class="variable">$suggestions</span>,</span><br><span class="line">            <span class="string">&#x27;complexity&#x27;</span> =&gt; <span class="built_in">self</span>::<span class="title function_ invoke__">calculateComplexity</span>(<span class="variable">$pattern</span>)</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 计算模式复杂度</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">calculateComplexity</span>(<span class="params"><span class="variable">$pattern</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$complexity</span> = <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 量词增加复杂度</span></span><br><span class="line">        <span class="variable">$complexity</span> += <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&#x27;/[*+?&#123;]/&#x27;</span>, <span class="variable">$pattern</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 字符类增加复杂度</span></span><br><span class="line">        <span class="variable">$complexity</span> += <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&#x27;/\[.*?\]/&#x27;</span>, <span class="variable">$pattern</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 分组增加复杂度</span></span><br><span class="line">        <span class="variable">$complexity</span> += <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&#x27;/\(.*?\)/&#x27;</span>, <span class="variable">$pattern</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 反向引用增加复杂度</span></span><br><span class="line">        <span class="variable">$complexity</span> += <span class="title function_ invoke__">preg_match_all</span>(<span class="string">&#x27;/\\\\[1-9]/&#x27;</span>, <span class="variable">$pattern</span>) * <span class="number">2</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$complexity</span> &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;low&#x27;</span>;</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (<span class="variable">$complexity</span> &lt;= <span class="number">15</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;medium&#x27;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;high&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 常用模式库</span></span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">COMMON_PATTERNS</span> = [</span><br><span class="line">        <span class="string">&#x27;email_simple&#x27;</span> =&gt; <span class="string">&#x27;/^[^@]+@[^@]+\.[^@]+$/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;email_strict&#x27;</span> =&gt; <span class="string">&#x27;/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]&#123;2,&#125;$/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;phone_loose&#x27;</span> =&gt; <span class="string">&#x27;/\d&#123;11&#125;/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;phone_strict&#x27;</span> =&gt; <span class="string">&#x27;/^1[3-9]\d&#123;9&#125;$/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;url_simple&#x27;</span> =&gt; <span class="string">&#x27;/https?:\/\/\S+/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;url_strict&#x27;</span> =&gt; <span class="string">&#x27;/^https?:\/\/[^\s\/$.?#].[^\s]*$/&#x27;</span></span><br><span class="line">    ];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 选择最优模式</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">selectOptimalPattern</span>(<span class="params"><span class="variable">$type</span>, <span class="variable">$strictness</span> = <span class="string">&#x27;medium&#x27;</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$patterns</span> = [</span><br><span class="line">            <span class="string">&#x27;email&#x27;</span> =&gt; [</span><br><span class="line">                <span class="string">&#x27;loose&#x27;</span> =&gt; <span class="built_in">self</span>::<span class="variable constant_">COMMON_PATTERNS</span>[<span class="string">&#x27;email_simple&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;medium&#x27;</span> =&gt; <span class="built_in">self</span>::<span class="variable constant_">COMMON_PATTERNS</span>[<span class="string">&#x27;email_strict&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;strict&#x27;</span> =&gt; <span class="string">&#x27;/^(?:[a-z0-9!#$%&amp;\&#x27;*+\/=?^_`&#123;|&#125;~-]+(?:\.[a-z0-9!#$%&amp;\&#x27;*+\/=?^_`&#123;|&#125;~-]+)*|&quot;(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\\\[\x01-\x09\x0b\x0c\x0e-\x7f])*&quot;)@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.)&#123;3&#125;(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/&#x27;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="string">&#x27;phone&#x27;</span> =&gt; [</span><br><span class="line">                <span class="string">&#x27;loose&#x27;</span> =&gt; <span class="built_in">self</span>::<span class="variable constant_">COMMON_PATTERNS</span>[<span class="string">&#x27;phone_loose&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;medium&#x27;</span> =&gt; <span class="built_in">self</span>::<span class="variable constant_">COMMON_PATTERNS</span>[<span class="string">&#x27;phone_strict&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;strict&#x27;</span> =&gt; <span class="string">&#x27;/^(?:\+86)?1[3-9]\d&#123;9&#125;$/&#x27;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="string">&#x27;url&#x27;</span> =&gt; [</span><br><span class="line">                <span class="string">&#x27;loose&#x27;</span> =&gt; <span class="built_in">self</span>::<span class="variable constant_">COMMON_PATTERNS</span>[<span class="string">&#x27;url_simple&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;medium&#x27;</span> =&gt; <span class="built_in">self</span>::<span class="variable constant_">COMMON_PATTERNS</span>[<span class="string">&#x27;url_strict&#x27;</span>],</span><br><span class="line">                <span class="string">&#x27;strict&#x27;</span> =&gt; <span class="string">&#x27;/^https?:\/\/(?:[-\w.])+(?:\:[0-9]+)?(?:\/(?:[\w\/_.])*(?:\?(?:[\w&amp;=%.])*)?(?:\#(?:[\w.])*)?)?$/&#x27;</span></span><br><span class="line">            ]</span><br><span class="line">        ];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$patterns</span>[<span class="variable">$type</span>][<span class="variable">$strictness</span>] ?? <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用性能优化器</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;=== 性能优化器示例 ===\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 性能测试</span></span><br><span class="line"><span class="variable">$testString</span> = <span class="string">&quot;联系邮箱：test@example.com，电话：13812345678&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$emailPatterns</span> = [</span><br><span class="line">    <span class="string">&#x27;simple&#x27;</span> =&gt; <span class="string">&#x27;/\S+@\S+/&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;medium&#x27;</span> =&gt; <span class="string">&#x27;/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]&#123;2,&#125;/&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;complex&#x27;</span> =&gt; <span class="string">&#x27;/^(?:[a-z0-9!#$%&amp;\&#x27;*+\/=?^_`&#123;|&#125;~-]+(?:\.[a-z0-9!#$%&amp;\&#x27;*+\/=?^_`&#123;|&#125;~-]+)*|&quot;(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\\\[\x01-\x09\x0b\x0c\x0e-\x7f])*&quot;)@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.)&#123;3&#125;(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/&#x27;</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="variable">$benchmarkResults</span> = <span class="title class_">RegexOptimizer</span>::<span class="title function_ invoke__">benchmarkPatterns</span>(<span class="variable">$emailPatterns</span>, <span class="variable">$testString</span>, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;邮箱模式性能测试结果 (100次迭代):\n&quot;</span>;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$benchmarkResults</span> <span class="keyword">as</span> <span class="variable">$name</span> =&gt; <span class="variable">$result</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;- <span class="subst">$name</span>: <span class="subst">&#123;$result[&#x27;time&#x27;]&#125;</span>ms 总时间, <span class="subst">&#123;$result[&#x27;avg_time&#x27;]&#125;</span>ms 平均时间\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模式分析</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n=== 模式分析 ===\n&quot;</span>;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$emailPatterns</span> <span class="keyword">as</span> <span class="variable">$name</span> =&gt; <span class="variable">$pattern</span>) &#123;</span><br><span class="line">    <span class="variable">$analysis</span> = <span class="title class_">RegexOptimizer</span>::<span class="title function_ invoke__">analyzePattern</span>(<span class="variable">$pattern</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;\n<span class="subst">$name</span> 模式分析:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;复杂度: <span class="subst">&#123;$analysis[&#x27;complexity&#x27;]&#125;</span>\n&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$analysis</span>[<span class="string">&#x27;suggestions&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;优化建议:\n&quot;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$analysis</span>[<span class="string">&#x27;suggestions&#x27;</span>] <span class="keyword">as</span> <span class="variable">$suggestion</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;- <span class="subst">$suggestion</span>\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;模式已优化\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 选择最优模式</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n=== 最优模式选择 ===\n&quot;</span>;</span><br><span class="line"><span class="variable">$optimalEmail</span> = <span class="title class_">RegexOptimizer</span>::<span class="title function_ invoke__">selectOptimalPattern</span>(<span class="string">&#x27;email&#x27;</span>, <span class="string">&#x27;medium&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;推荐的邮箱验证模式: <span class="subst">$optimalEmail</span>\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$optimalPhone</span> = <span class="title class_">RegexOptimizer</span>::<span class="title function_ invoke__">selectOptimalPattern</span>(<span class="string">&#x27;phone&#x27;</span>, <span class="string">&#x27;strict&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;推荐的手机号验证模式: <span class="subst">$optimalPhone</span>\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>通过本文的学习，我们全面掌握了PHP正则表达式的使用技巧：</p>
<h3 id="关键要点"><a href="#关键要点" class="headerlink" title="关键要点"></a>关键要点</h3><ol>
<li><strong>基础语法</strong>: 掌握了preg_match、preg_replace、preg_split等核心函数</li>
<li><strong>高级模式</strong>: 学会了复杂的模式匹配和数据提取技巧</li>
<li><strong>实际应用</strong>: 了解了数据验证、日志分析、文本处理等实用场景</li>
<li><strong>性能优化</strong>: 掌握了正则表达式的性能优化方法</li>
</ol>
<h3 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h3><ul>
<li>使用锚点提高匹配效率</li>
<li>优先使用非捕获组减少内存消耗</li>
<li>避免过度使用贪婪量词</li>
<li>缓存编译后的正则表达式</li>
<li>根据需求选择合适的严格程度</li>
</ul>
<h3 id="安全建议"><a href="#安全建议" class="headerlink" title="安全建议"></a>安全建议</h3><ul>
<li>验证用户输入防止注入攻击</li>
<li>使用白名单而不是黑名单</li>
<li>对正则表达式进行性能测试</li>
<li>避免复杂的回溯模式</li>
<li>定期更新验证规则</li>
</ul>
<p>掌握这些正则表达式技巧，将大大提高你处理文本数据的能力和效率。记住，正则表达式是一把双刃剑，合理使用能事半功倍，过度使用可能影响性能。</p>

                    
                </div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                            <ul class="post-tags-box border-box">
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">正则表达式</a>
                                    </li>
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86/">文本处理</a>
                                    </li>
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/">模式匹配</a>
                                    </li>
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/PHP%E5%9F%BA%E7%A1%80/">PHP基础</a>
                                    </li>
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81/">数据验证</a>
                                    </li>
                                
                            </ul>
                        
                    </div>
                    <div>
                        
                    </div>
                </div>

                

                
                    <div class="post-nav border-box">
                        
                            <div class="prev-post">
                                <a class="prev"
                                   rel="prev"
                                   href="/2023/fastapi/fastapi-error-handling-logging/"
                                   title="FastAPI错误处理与日志系统：构建健壮的生产级应用"
                                >
                                    <span class="left arrow-icon flex-center">
                                        <i class="fas fa-chevron-left"></i>
                                    </span>
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">FastAPI错误处理与日志系统：构建健壮的生产级应用</span>
                                        <span class="post-nav-item">上一篇</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="next-post">
                                <a class="next"
                                   rel="next"
                                   href="/2023/php/php-forms-validation-guide/"
                                   title="PHP表单处理与验证完全指南"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">PHP表单处理与验证完全指南</span>
                                        <span class="post-nav-item">下一篇</span>
                                    </span>
                                    <span class="right arrow-icon flex-center">
                                        <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    






                
            </div>
        </div>

        
            <div class="pc-post-toc right-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#PHP%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%AE%9E%E6%88%98%E6%8C%87%E5%8D%97%EF%BC%9A%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D%E4%B8%8E%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86"><span class="nav-text">PHP正则表达式实战指南：模式匹配与文本处理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9F%BA%E7%A1%80"><span class="nav-text">正则表达式基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E5%92%8C%E5%87%BD%E6%95%B0"><span class="nav-text">1. 基本语法和函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E9%AB%98%E7%BA%A7%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D"><span class="nav-text">2. 高级模式匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E5%92%8C%E5%86%85%E5%AE%B9%E6%8F%90%E5%8F%96"><span class="nav-text">3. 文本处理和内容提取</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">实际应用场景</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81%E5%92%8C%E6%B8%85%E7%90%86"><span class="nav-text">1. 数据验证和清理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E5%92%8C%E7%9B%91%E6%8E%A7"><span class="nav-text">2. 日志分析和监控</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%92%8C%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-text">性能优化和最佳实践</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-text">总结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E8%A6%81%E7%82%B9"><span class="nav-text">关键要点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-text">最佳实践</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%AE"><span class="nav-text">安全建议</span></a></li></ol></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>
        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="copyright-info info-item">
    &copy;&nbsp;2025
    
            &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">Orion K</a>
        
    </div>


    
        
        <div class="deploy-info info-item">
            
            本站由 <span class="tooltip" data-tooltip-content="GitHub Pages"><img src="/images/brands/github.png"></span> 提供部署服务
            
        </div>
    

    

    
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            <div class="post-tools-container border-box">
    <ul class="post-tools-list border-box">
        <!-- PC encrypt again -->
        

        <!-- PC TOC show toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- PC go comment -->
        

        <!-- PC full screen -->
        <li class="tools-item flex-center full-screen">
            <i class="fa-solid fa-expand"></i>
        </li>
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <!-- toggle mode -->
        
            <li class="tools-item tool-toggle-theme-mode flex-center">
                <i class="fas fa-moon"></i>
            </li>
        

        <!-- rss -->
        

        <!-- to bottom -->
        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#PHP%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%AE%9E%E6%88%98%E6%8C%87%E5%8D%97%EF%BC%9A%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D%E4%B8%8E%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86"><span class="nav-text">PHP正则表达式实战指南：模式匹配与文本处理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9F%BA%E7%A1%80"><span class="nav-text">正则表达式基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E5%92%8C%E5%87%BD%E6%95%B0"><span class="nav-text">1. 基本语法和函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E9%AB%98%E7%BA%A7%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D"><span class="nav-text">2. 高级模式匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E5%92%8C%E5%86%85%E5%AE%B9%E6%8F%90%E5%8F%96"><span class="nav-text">3. 文本处理和内容提取</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">实际应用场景</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81%E5%92%8C%E6%B8%85%E7%90%86"><span class="nav-text">1. 数据验证和清理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E5%92%8C%E7%9B%91%E6%8E%A7"><span class="nav-text">2. 日志分析和监控</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%92%8C%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-text">性能优化和最佳实践</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-text">总结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E8%A6%81%E7%82%B9"><span class="nav-text">关键要点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-text">最佳实践</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%AE"><span class="nav-text">安全建议</span></a></li></ol></li></ol></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>





<!-- common js -->

<script src="/js/utils.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/toggle-theme.js"></script>

<script src="/js/code-block.js"></script>

<script src="/js/main.js"></script>

<script src="/js/libs/anime.min.js"></script>


<!-- local search -->

    
<script src="/js/local-search.js"></script>



<!-- lazyload -->


<div class="">
    <!-- home page -->
    

    <!-- post page -->
    
        <!-- post-helper -->
        
<script src="/js/post/post-helper.js"></script>


        <!-- toc -->
        
            
<script src="/js/post/toc.js"></script>

        

        <!-- copyright-info -->
        

        <!-- share -->
        
    

    <!-- categories page -->
    

    <!-- links page -->
    

    <!-- photos page -->
    

    <!-- tools page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



</body>
</html>
